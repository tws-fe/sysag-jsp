<HTML>
<HEAD>
<TITLE>PersonCardDetect.CAB</TITLE>
</HEAD>
<BODY>
<!--	如果这页上的任何控件需要授权，您必须
	创建一个授权包文件。 运行 LPK_TOOL.EXE 来创建
	要求的 LPK 文件。 LPK_TOOL.EXE 将从 ActiveX SDK 中找到，
	http://www.microsoft.com/intdev/sdk/sdk.htm. 如果您有 Visual
	Basic 6.0 CD, 您可以在\Tools\LPK_TOOL 目录下找到它。

	下面是对象标记的例子：

<OBJECT CLASSID="clsid:5220cb21-c88d-11cf-b347-00aa00a28331">
	<PARAM NAME="LPKPath" VALUE="LPKfilename.LPK">
</OBJECT>
-->

<OBJECT ID="ReadControl"
CLASSID="CLSID:88486E17-DBA4-4BDD-852E-1B917C817045"
CODEBASE="PersonCardDetect.CAB#version=1,0,0,0"	height=420 width=860>
</OBJECT><br>

<input type="button"  value='确定'  onclick='myClose()'/>



<script>
myOpen();
function myOpen(){
	var o=document.getElementById('ReadControl');
	
	if (o){
		o.funOpen();
		o.funBeginDetect();
	}
	
}

function myClose(){
	var o=document.getElementById('ReadControl');
	
	if (o){
		/*
		var card = {
			'pCardId':o.pCardId,
			'pCardName':o.pCardName,
			'pCardSex':o.pCardSex,
			'pCardNation':o.pCardNation,
			'pCardBirthday':o.pCardBirthday,
			'pCardAddress':o.pCardAddress
			};			
	
		
		*/
		var card = {};
		for(var p in o){
			card[p] = o[p];
		}
		
  		window.returnValue = card;
  		o.funClose();
  		window.close();
  				
	}else{
		alert(222);
	}
	
	
	
}
</script>

<SCRIPT FOR=ReadControl EVENT=EventReadOk>
	
	//alert(ReadControl.pCardId);
	
	//var o=document.getElementById('ReadControl');
	
	//var o=document.getElementById('mycard');
	//o.value=ReadControl.pCardId;
	
</SCRIPT>

</BODY>
</HTML>

