!function(j,Z,a){"use strict";var H="ht",B=j[H],h=B.Default,v=B.graph,Y=h.getInternal(),T=Y.ui(),S=T.NodeUI.prototype,W=T.ShapeUI.prototype,N=v.GraphView,m=N.prototype,i=T.EdgeUI.prototype,A=B.Node,u=B.Shape,f=B.Edge,J=B.Group,G=h.isTouchable,z=h.preventDefault,w=j.setTimeout,V=h.grow,U=h.isDragging,$=h.getDistance,l=null,o=B.List,Q="undefined"!=typeof Float32Array?Float32Array:Array,C=Math,L=C.PI,p="Crossing",K="No Crossing",I=L/2,s=2*L,r=C.atan2,R=C.sqrt,k=C.pow,c=C.sin,M=C.cos,_=C.min,P=C.max,d=C.abs,D=C.ceil,n=C.round,F=h.unionPoint,e=h.unionRect,O=h.containsPoint,g=h.clone,X="rgb(52, 152, 219)",y="red",E={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},q={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var N=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],E=0;E<N.length;E++){var T=N[E];T=0===E%2?T/400*q.width:T/100*q.height,N[E]=T}return q.width>120&&(N[4]=q.width-26,N[6]=q.width-40,N[10]=q.width-40,N[12]=q.width-26,N[18]=33),N}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},b={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:X,rotation:.61},{type:"circle",rect:[200,120,70,70],background:X,rotation:.61},{type:"circle",rect:[200,220,70,70],background:X,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:X},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:X}]},x={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:y,rotation:.61}]},t={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:X},{type:"circle",rect:[0,210,90,90],background:X},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:X}]},Wj={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:y},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:y}]},lc={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:X}]},vo={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:y}]},tj={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Lp={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Jn=function(K){var M=K.touches[0];return M?M:K.changedTouches[0]},tm=function(E,M,v,x){return r(x-M,v-E)},dp=function(d,J){return{x:d.x*J,y:d.y*J}},sm=function(y,m){var $,R,V,H,w=y._layers,s=y.sm().getSelection()._as,t=s.length;if(w)for($=0;$<w.length;$++){H=w[$];for(var q=0;t>q;q++)if(R=s[q],R._layer===H&&(V=m(R),V===!1))return}else for($=0;t>$;$++)if(R=s[$],V=m(R),V===!1)return},Cb=function(_,F,i){var J,C,W,p,g,q=this,G=F,X=q.gv;if(_ instanceof u){W=_.getSegments();var I=X.getDataUI(_);g=I._55O.$15l,W||(W=Nj(g)),_.isClosePath()&&W.indexOf(5)<0&&(W=new o(W._as),W.add(5)),J=Me(_,I,G),C=g[J]}else{var c=X.getDataUI(_);g=vn(c,_.s("edge.points")),W=_.s("edge.segments"),W||(W=Nj(g)),g=g._as,J=Me(_,c,G),C=g[J]}if(W&&(p=W.get(G)),2===p||1===p||5===p){var Q=g[J+1];5===p&&(Q=g[0]);var w=nh(C,i,Q);return w}return i},yi=function(v,H){var o,B,z,w,U=v._layers,M=v.sm().getSelection()._as,W=M.length;if(U)for(o=U.length-1;o>=0;o--){w=U[o];for(var I=W-1;I>=0;I--)if(B=M[I],B._layer===w&&(z=H(B),z===!1))return}else for(o=W-1;o>=0;o--)if(B=M[o],z=H(B),z===!1)return},xj=function(k,e,S,X){var n=e/2,L=S/2,a=ib(k,-n,-L,X),H=ib(k,n,-L,X),O=ib(k,-n,L,X),y=ib(k,n,L,X),u=ib(k,0,-L,X),w=ib(k,n,0,X),v=ib(k,0,L,X),z=ib(k,-n,0,X);return[a,H,O,y,u,w,v,z]},nh=function(x,c,b){var U={x:c.x-x.x,y:c.y-x.y},n={x:b.x-x.x,y:b.y-x.y},i=R(k(b.x-x.x,2)+k(b.y-x.y,2)),Z={x:n.x/i,y:n.y/i},$=U.x*Z.x+U.y*Z.y,y={x:Z.x*$,y:Z.y*$};return{x:x.x+y.x,y:x.y+y.y}},ib=function(g,L,s,E){var k=M(E)*L-c(E)*s,w=c(E)*L+M(E)*s;return g?{x:g.x+k,y:g.y+w}:{x:k,y:w}},zk=function(e,o){return o>2*e?e:o/2},Ho=function(h,q,D,z){var R=$(h,q);return D=z?_(D,R):zk(D,R),R?D/=R:D=0,{x:h.x+(q.x-h.x)*D,y:h.y+(q.y-h.y)*D}},bk=function(j,T,c,Q,$){return T?(c=Y.getPosition(c,Y.getNodeRect(j,T)),c.x+=Q||0,c.y+=$||0,c):l},Zi=function(n,x){var k,Z,Q=n.gv,U=n._data,J=U._40I,C=U._41I,H=U.s("edge.offset"),a=U.s("edge.source.position"),l=U.s("edge.target.position"),g=U.s("edge.source.offset.x"),y=U.s("edge.source.offset.y"),r=U.s("edge.target.offset.x"),G=U.s("edge.target.offset.y");if(x?(k=bk(Q,J,a,g,y),Z=bk(Q,C,l,r,G)):(k=bk(Q,J,a),Z=bk(Q,C,l)),"points"===U.s("edge.type")&&H&&!U.s("edge.center")&&k){var e=U.s("edge.points")||new o,D=e.size(),d=Ho(k,D?e.get(0):Z,H,D),E=Ho(Z,D?e.get(D-1):k,H,D);k=d,Z=E}return[k,Z]},vn=function(N,J,Z){var g=N._78o,X=N._data,R=X.s("edge.type"),h=[g._69o,g._70o];return"points"===R?Z&&(h=Zi(N)):h=g.center?R?Z?Zi(N):Zi(N,!0):Z?Zi(N):[g.c1,g.c2]:Z?Zi(N):Zi(N,!0),J=new o(J?J._as:l),J.add(h[0],0),J.add(h[1]),J},Lr=function(W){return W=new o(W._as),W.removeAt(0),W.removeAt(W.size()-1),W},Nj=function(n){n._as||(n=new o(n));var t=new o;t.add(1);for(var S=1;S<n.size();S++)t.add(2);return t},Vo=function(Y,a){return{x:(Y.x+a.x)/2,y:(Y.y+a.y)/2}},Rb=function(w,S){return{x:w.x+1*(S.x-w.x)/4,y:w.y+1*(S.y-w.y)/4}},xq=function(e,n){return{x:e.x+3*(n.x-e.x)/4,y:e.y+3*(n.y-e.y)/4}},ws=function(j,F,o,Y){var k=F.x+F.width/2,q=F.y+F.height/2,z=R(k*k+q*q),I=r(q,k)+o;return{x:Y.x+z*M(I),y:Y.y+z*c(I)}},jm=m.validateImpl,dr=m.isRectEditable,Ej=m.isPointEditable,Om=m._42,oi=W._79o,Pl=i._79o,Hl=W._48O,Um=W._47O,pp=S._48O,go=S._80o,of=W._80o,bd=S._2o,ig=S._47O,On=i._47O,km=m.isEditable,rd=["northwest","north","northeast","east","southeast","south","southwest","west"],Uj=function(a,b,N,j,I,k,C,q,G,H){var Z=a.x,D=a.y,w=a.width,P=a.height,E={x:Z+w/2,y:D+P/2};j=j||0,b=ib(E,b.x-E.x,b.y-E.y,-j),C&&!q&&(b.x+=G,b.y+=H);var L=.01;if("northwest"===N?(b.x+I>Z+w-L&&(b.x=Z+w-I-L),b.y+I>D+P-L&&(b.y=D+P-I-L),a=F(b,{x:Z+w,y:D+P})):"north"===N?(b.y+I>D+P-L&&(b.y=D+P-I-L),a=F({x:Z,y:b.y},{x:Z+w,y:D+P})):"northeast"===N?(b.x<Z+I+L&&(b.x=Z+I+L),b.y+I>D+P-L&&(b.y=D+P-I-L),a=F({x:Z,y:b.y},{x:b.x,y:D+P})):"west"===N?(b.x+I>Z+w-L&&(b.x=Z+w-I-L),a=F({x:b.x,y:D},{x:Z+w,y:D+P})):"east"===N?(b.x<Z+I+L&&(b.x=Z+I+L),a=F({x:Z,y:D},{x:b.x,y:D+P})):"southwest"===N?(b.x+I>Z+w-L&&(b.x=Z+w-I-L),b.y<D+I+L&&(b.y=D+I+L),a=F({x:b.x,y:D},{x:Z+w,y:b.y})):"south"===N?(b.y<D+I+L&&(b.y=D+I+L),a=F({x:Z,y:D},{x:Z+w,y:b.y})):"southeast"===N&&(b.x<Z+I+L&&(b.x=Z+I+L),b.y<D+I+L&&(b.y=D+I+L),a=F({x:Z,y:D},b)),"keepRatio"===k&&(!C&&q||C&&!q)&&("northeast"===N||"southeast"===N||"northwest"===N||"southwest"===N)){var A=a.width,$=a.height,t=A/w,h=$/P,x=_(t,h);a.width=w*x,a.height=P*x,"northeast"===N?a.y=D+(P-a.height):"northwest"===N?(a.y=D+(P-a.height),a.x=Z+(w-a.width)):"southwest"===N&&(a.x=Z+(w-a.width))}a.x-=E.x,a.y-=E.y;var B=ws(l,a,j,E);return a.x=B.x-a.width/2,a.y=B.y-a.height/2,a},Qh=function(d,H,t,n){var i=d.getRotation(),h=H,O=h.x,r=h.y,J=h.width,g=h.height,E={x:O+h.width/2,y:r+h.height/2};n=ib(E,n.x-E.x,n.y-E.y,-i),"northwest"===t?h=F(n,{x:O+J,y:r+g}):"north"===t?h=F({x:O,y:n.y},{x:O+J,y:r+g}):"northeast"===t?h=F({x:O,y:n.y},{x:n.x,y:r+g}):"west"===t?h=F({x:n.x,y:r},{x:O+J,y:r+g}):"east"===t?h=F({x:O,y:r},{x:n.x,y:r+g}):"southwest"===t?h=F({x:n.x,y:r},{x:O+J,y:n.y}):"south"===t?h=F({x:O,y:r},{x:O+J,y:n.y}):"southeast"===t&&(h=F({x:O,y:r},n)),d.setRect(h),h.x-=E.x,h.y-=E.y;var X=ws(d,h,i,E);d.p(X.x,X.y)},Ak=function(b,q,c,_,r,s,D,w){var S=l;s?(S=ib(l,r.x-q.x,r.y-q.y,-c),S.x-=D.x,S.y-=D.y):S=ib(l,r.x-q.x,r.y-q.y,0);var v={x:q.x+S.x,y:q.y+S.y};w&&(v=w(v.x,v.y)),v.e=b.getPoints().get(_).e,b.setPoint(_,v);var Z=b.getWidth(),V=b.getHeight(),O=b.p().x-Z/2,a=b.p().y-V/2;O-=q.x,a-=q.y;var h=ws(b,{x:O,y:a,width:Z,height:V},c,q);b.p(h.x,h.y)},Me=function(I,U,T){var S,d;if(I instanceof u?(S=I.getPoints(),d=I.getSegments()):I instanceof f&&"points"===I.s("edge.type")&&(S=I.s("edge.points"),d=I.s("edge.segments"),S=vn(U,S)),d||(d=Nj(S)),I instanceof u&&I.isClosePath()&&d.indexOf(5)<0&&(d=new o(d._as),d.add(5)),d)for(var s=-1,l=0;l<d.size();l++){if(l===T)return s;var k=d.get(l);1===k?s+=1:2===k?s+=1:3===k?s+=2:4===k&&(s+=3)}},Rg=function(S,J,e){var B,k;if(S instanceof u?(B=S.getPoints(),k=S.getSegments()):S instanceof f&&"points"===S.s("edge.type")&&(B=S.s("edge.points"),k=S.s("edge.segments"),B=vn(J,B)),k||(k=Nj(B)),k)for(var Z=-1,$=0;$<k.size();$++){var b=k.get($);if(1===b?Z+=1:2===b?Z+=1:3===b?Z+=2:4===b&&(Z+=3),Z===e)return $}},Qm=function($,x){var s=[$[0]-x[0],$[1]-x[1],$[2]-x[2]];return s},uc=function(){var Z=new Q(16);return Z[0]=1,Z[1]=0,Z[2]=0,Z[3]=0,Z[4]=0,Z[5]=1,Z[6]=0,Z[7]=0,Z[8]=0,Z[9]=0,Z[10]=1,Z[11]=0,Z[12]=0,Z[13]=0,Z[14]=0,Z[15]=1,Z},Dp=function(k,Q){var f=k[0],L=k[1],X=k[2];return k[0]=Q[0]*f+Q[4]*L+Q[8]*X+Q[12],k[1]=Q[1]*f+Q[5]*L+Q[9]*X+Q[13],k[2]=Q[2]*f+Q[6]*L+Q[10]*X+Q[14],k},vi=function(i,p){if(p){var W=c(p),D=M(p),F=i[0],K=i[1],b=i[2],I=i[3],G=i[8],Z=i[9],J=i[10],d=i[11];i[0]=F*D-G*W,i[1]=K*D-Z*W,i[2]=b*D-J*W,i[3]=I*D-d*W,i[8]=F*W+G*D,i[9]=K*W+Z*D,i[10]=b*W+J*D,i[11]=I*W+d*D}},_i=function(a,s){for(var n=a.s("grid.row.count"),Q=a.s("grid.column.count"),N=0;n>N;N++)for(var z=0;Q>z;z++){var I=a.getCellRect(N,z);if(O(I,s))return{rowIndex:N,columnIndex:z,rect:I,grid:a}}return null},Sf=function(F,U,x,d,P,O){var K={},A=x-F,X=d-U,$=C.sqrt(A*A+X*X),B=A/$,S=X/$,Y=(-F+P)*B+(-U+O)*S;return 0>=Y?(K.x=F,K.y=U):Y>=$?(K.x=x,K.y=d):(K.x=F+Y*B,K.y=U+Y*S),A=P-K.x,X=O-K.y,K.z=C.sqrt(A*A+X*X),K},pk=function(y,Y){var C,t,N,k,m,g,R,p,_=y.getPoints(),M=y.getSegments(),z=y.p(),J=y.getRotation();if(!M||!(M.indexOf(3)>0||M.indexOf(4)>0)){for(p=0;p<=_.size()-1;p++)if(p===_.size()-1?(m=_.get(0),k=_.get(p)):(k=_.get(p),m=_.get(p+1)),k=ib(z,k.x-z.x,k.y-z.y,J),m=ib(z,m.x-z.x,m.y-z.y,J),g=Sf(k.x,k.y,m.x,m.y,Y.x,Y.y),R=g.z,R<(y.s("shape.border.width")||10)){t=k,N=m,C=p;break}if(C!=l){var b=Sf(t.x,t.y,N.x,N.y,Y.x,Y.y),L=$(t,b);return{attachIndex:C,attachOffset:L}}}},Ef=function(n){for(var a=n._data,i=a.p(),B=a.getRotation(),g=a.getPoints(),C=l,k=[],M=0;M<g.size();M++)C=g.get(M),k.push(ib(i,C.x-i.x,C.y-i.y,B));n._55O.$15l=k};m._editPointSize=G?24:9,m._edgeHelpers=["parent","remove","source","target"],m._leftTopHelpers=["parent"],m._rightTopHelpers=["host"],m._leftBottomHelpers=["edge"],m._rightBottomHelpers=["remove"],rd=rd.concat(rd).concat(rd),i._79o=function(){var C=this,U=C.gv,m=U.getZoom(),M=U._editInteractor,l=Pl.call(C),N=Zi(C,!0),S=N[0],p=N[1],q={x:l.x,y:l.y,width:l.width,height:l.height},g=F(S,p);if(M instanceof v.XEditInteractor){q=e(q,g);var s=C._55O,P=U.getEditPointSize()/m+2,b=0;s&&s._43O&&(b+=P/2,V(q,b))}return q},i._47O=function(L){var b=this,y=b.gv,f=y._editInteractor;f instanceof v.XEditInteractor||On.call(b,L)},i.rectIntersects=function(X){var C=this,r=C._data,Y=C.gv,H=Y.getZoom(),z=C._55O,k=Y._editInteractor;if(k instanceof v.XEditInteractor&&Y.isEditable(r)&&z&&z._43O&&"points"===r.s("edge.type")){var q=r.s("edge.points"),R=r.s("edge.segments");q=vn(C,q),R||(R=Nj(q)),q=q._as;var _=!1,B=G?5:1,e=X.x+B,g=X.y+B,N={x:e,y:g};if(k._edge===r&&k._hoverSegmentIndex>=0){var W=Y._editInteractor._hoverSegmentIndex,K=R.get(W),Z=Me(r,C,W),O=l;if(Z!=l&&Z>=0){var L=q[Z],n=Y.getSegmentHoverWidth()/H;if(2===K||1===K){var t=q[Z+1];O=ck(new Bm(L.x,L.y),new Bm(t.x,t.y),new Bm(N.x-n,N.y-n),new Bm(N.x+2*n,N.y+2*n)),O.$62l===p&&(_=!0)}else if(3===K){var d=q[Z+1],t=q[Z+2];O=Vb(new Bm(L.x,L.y),new Bm(d.x,d.y),new Bm(t.x,t.y),new Bm(N.x-n,N.y-n),new Bm(N.x+2*n,N.y+2*n)),O.$62l===p&&(_=!0)}else if(4===K){var Q=q[Z+1],j=q[Z+2];t=q[Z+3],O=Tg(new Bm(L.x,L.y),new Bm(Q.x,Q.y),new Bm(j.x,j.y),new Bm(t.x,t.y),new Bm(N.x-n,N.y-n),new Bm(N.x+2*n,N.y+2*n)),O.$62l===p&&(_=!0)}}}if(_)return!0}return l},W._47O=function(P){var D=this,w=D.gv,B=w._editInteractor;B instanceof v.XEditInteractor||Um.call(D,P)},W.rectIntersects=function(j){var e=this,J=e._data,k=e.gv,X=k.getZoom(),M=e._55O,E=k._editInteractor;if(E instanceof v.XEditInteractor&&k.isEditable(J)&&M&&M._43O){var W=M.$15l,Z=!1,S=G?5:1,H=j.x+S,T=j.y+S,D={x:H,y:T};if(W&&W.length===J.getPoints().size()||(Ef(e),W=M.$15l),E._shape===J&&E._hoverSegmentIndex>=0){var q=J.getSegments();q||(q=Nj(W));var R=k._editInteractor._hoverSegmentIndex,z=q.get(R),I=Me(J,e,R),f=l;if(I!=l&&I>=0){var F=W[I],C=k.getSegmentHoverWidth()/X;if(2===z||1===z){var n=W[I+1];f=ck(new Bm(F.x,F.y),new Bm(n.x,n.y),new Bm(D.x-C,D.y-C),new Bm(D.x+2*C,D.y+2*C)),f.$62l===p&&(Z=!0)}else if(3===z){var m=W[I+1],n=W[I+2];f=Vb(new Bm(F.x,F.y),new Bm(m.x,m.y),new Bm(n.x,n.y),new Bm(D.x-C,D.y-C),new Bm(D.x+2*C,D.y+2*C)),f.$62l===p&&(Z=!0)}else if(4===z){var u=W[I+1],x=W[I+2];n=W[I+3],f=Tg(new Bm(F.x,F.y),new Bm(u.x,u.y),new Bm(x.x,x.y),new Bm(n.x,n.y),new Bm(D.x-C,D.y-C),new Bm(D.x+2*C,D.y+2*C)),f.$62l===p&&(Z=!0)}}}if(Z)return!0}return l},W._48O=function(){var W=this,Z=W.gv,f=Z._editInteractor;f instanceof v.XEditInteractor?(S._48O.call(W),W._55O._43O&&Ef(W)):Hl.call(W)},W._79o=function(){var o=this,C=o.gv,$=C.getZoom(),J=C._editInteractor,X=oi.call(o);if(X){var q={x:X.x,y:X.y,width:X.width,height:X.height};if(J instanceof v.XEditInteractor){var t=o._55O,b=C.getEditPointSize()/$+2,Y=0;t&&t._43O&&(Y+=b/2,V(q,Y))}return q}},S._47O=function(_){var A=this,g=A.gv,l=g._editInteractor;if(l instanceof v.XEditInteractor);else{var y=A._55O;y&&y._98o&&ig.call(A,_)}},S._2o=function(){var N=this,J=N.gv,h=J._editInteractor,l=N._data;return J.isEditable(l)&&h instanceof v.XEditInteractor?0:bd.call(N)},S._80o=function(x){var o=this,K=o.gv._editInteractor;if(go.call(o,x),K&&K._debug){x.save(),x.beginPath(),x.lineWidth=1,x.strokeStyle="green";var A=o._79o();A&&(x.rect(A.x,A.y,A.width,A.height),x.stroke()),x.restore()}},W._80o=function(g){var X=this,O=X.gv._editInteractor;if(of.call(X,g),O&&O._debug){g.save(),g.beginPath(),g.lineWidth=1,g.strokeStyle="green";var W=X._79o();g.rect(W.x,W.y,W.width,W.height),g.stroke(),g.restore()}},S._48O=function(){var q=this,u=q.gv,W=q._data,j=u._editInteractor,m=q._55O,P=W.p(),s=W.getRotation();if(j instanceof v.XEditInteractor){if(m._42O){var M=xj(P,W.getWidth(),W.getHeight(),s),r=M[0],z=M[1],a=M[2],T=M[3],D=M[4],U=M[5],L=M[6],t=M[7];m.$45l=[r,D,z,U,T,L,a,t]}}else pp.call(q)},m.getResizeMode=function(){return this.$25l||"normal"},m.setResizeMode=function(T){var O=this.$25l;this.$25l=T,this.fp("resizeMode",O,T)},m.getSnapAngle=function(){return this.$26l||Math.PI/36},m.setSnapAngle=function(m){var q=this.$26l;this.$26l=m,this.fp("snapAngle",q,m)},m.getSnapSpacing=function(){return this.$27l},m.setSnapSpacing=function(l){var P=this.$27l;this.$27l=l,this.fp("snapSpacing",P,l)},m.getPointSnapSpacing=function(){return this._pointSnapSpacing},m.setPointSnapSpacing=function(N){var V=this._pointSnapSpacing;this._pointSnapSpacing=N,this.fp("pointSnapSpacing",V,N)},m.setHelperEditableFunc=function(m){var p=this._helperEditableFunc;this._helperEditableFunc=m,this.fp("helperEditableFunc",p,m)},m.getHelperEditableFunc=function(){return this._helperEditableFunc},m.setLeftTopHelpers=function(t){var m=this._leftTopHelpers;this._leftTopHelpers=t,this.fp("leftTopHelpers",m,t)},m.getLeftTopHelpers=function(){return this._leftTopHelpers},m.setLeftTopHelpersAlign=function(B){var I=this._leftTopHelpersAlign;this._leftTopHelpersAlign=B,this.fp("leftTopHelpersAlign",I,B)},m.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},m.setRightTopHelpers=function(d){var R=this._rightTopHelpers;this._rightTopHelpers=d,this.fp("rightTopHelpers",R,d)},m.getRightTopHelpers=function(){return this._rightTopHelpers},m.setRightTopHelpersAlign=function(p){var Q=this._rightTopHelpersAlign;this._rightTopHelpersAlign=p,this.fp("rightTopHelpersAlign",Q,p)},m.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},m.setLeftBottomHelpers=function(Q){var S=this._leftBottomHelpers;this._leftBottomHelpers=Q,this.fp("leftBottomHelpers",S,Q)},m.getLeftBottomHelpers=function(){return this._leftBottomHelpers},m.setLeftBottomHelpersAlign=function(g){var X=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=g,this.fp("leftBottomHelpersAlign",X,g)},m.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},m.setRightBottomHelpers=function(o){var R=this._rightBottomHelpers;this._rightBottomHelpers=o,this.fp("rightBottomHelpers",R,o)},m.getRightBottomHelpers=function(){return this._rightBottomHelpers},m.setRightBottomHelpersAlign=function(n){var N=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=n,this.fp("rightBottomHelpersAlign",N,n)},m.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},m.setEdgeHelpers=function(r){var F=this._edgeHelpers;this._edgeHelpers=r,this.fp("edgeHelpers",F,r)},m.getEdgeHelpers=function(){return this._edgeHelpers},m.isHelperEditable=function(F,k){return F instanceof f&&("host"===k||"edge"===k||"elevation"===k||"tall"===k)?!1:F instanceof A&&("source"===k||"target"===k)?!1:"pointElevation"===k?this._helperEditableFunc?this._helperEditableFunc(F,k):!1:this._helperEditableFunc?this._helperEditableFunc(F,k):!0},m.getEditHelperSize=function(){return this._editHelperSize||(G?28:16)},m.setEditHelperSize=function($){var I=this._editHelperSize;this._editHelperSize=$,this.fp("editHelperSize",I,$)},m.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},m.setEditRectBorderColor=function(u){var w=this.$28l;this.$28l=u,this.fp("editRectBorderColor",w,u)},m.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},m.setNodeBorderColor=function(r){var e=this.$29l;this.$29l=r,this.fp("nodeBorderColor",e,r)},m.getEditRectBorderStyle=function(){return this.$30l||"dashed"},m.setEditRectBorderStyle=function(H){var Z=this.$30l;this.$30l=H,this.fp("editRectBorderStyle",Z,H)},m.getControlPointBackground=function(){return this.$31l||"#ff0"},m.setControlPointBackground=function(J){var _=this.$31l;this.$31l=J,this.fp("controlPointBackground",_,J)},m.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},m.setControlPointBorderColor=function(V){var m=this.$32l;this.$32l=V,this.fp("controlPointBorderColor",m,V)},m.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},m.setJoinPointBackground=function(C){var L=this.$33l;this.$33l=C,this.fp("joinPointBackground",L,C)},m.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},m.setJoinPointBorderColor=function(I){var o=this.$34l;this.$34l=I,this.fp("joinPointBorderColor",o,I)},m.getDirectionLineColor=function(){return this.$35l||"#888"},m.setDirectionLineColor=function(a){var i=this.$35l;this.$35l=a,this.fp("directionLineColor",i,a)},m.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},m.setSegmentHoverColor=function(K){var d=this.$36l;this.$36l=K,this.fp("segmentHoverColor",d,K)},m.getSegmentHoverWidth=function(){return this.$22l||(G?16:8)},m.setSegmentHoverWidth=function(K){var k=this.$22l;this.$22l=K,this.fp("segmentHoverWidth",k,K)},m.getSnapPointBorderColor=function(){return this.$38l||"#f00"},m.setSnapPointBorderColor=function(O){var T=this.$38l;this.$38l=O,this.fp("snapPointBorderColor",T,O)},m.getEditRectPadding=function(){return this.$39l!=l?this.$39l:6},m.setEditRectPadding=function(T){var w=this.$39l;this.$39l=T,this.fp("editRectPading",w,T)},m.isRectEditable=function(r){var L=this,P=L._editInteractor;return P instanceof v.XEditInteractor?L._rectEditableFunc?L._rectEditableFunc(r):!0:dr.call(L,r)},m.isPointEditable=function(E){var F=this,$=F._editInteractor;return $ instanceof v.XEditInteractor?F._pointEditableFunc?F._pointEditableFunc(E):!0:Ej.call(F,E)},m.validateImpl=function(){var e=this,t=e.$14l,U=e._editInteractor;if(t){var w=e.getWidth(),D=e.getHeight();(w!==t.clientWidth||D!==t.clientHeight)&&(U&&(U._68I=1),Y.setCanvas(t,w,D),e._32I=1)}jm.call(this)},m.isEditable=function(K){var Y=km.call(this,K),c=this._editInteractor;if(c instanceof v.XEditInteractor&&K instanceof f){K.getSource()==K.getTarget()&&(Y=!1);var o=this.getEditableFunc();Y=o?o(K):!0}return Y},m._42=function(B,j){var G=this,Q=G._editInteractor;Om.call(G,B,j),Q instanceof v.XEditInteractor&&Q._68I&&Q._42()},m.isSnapPoint=function(){return!0};var ag=function(N){arguments.length>0&&this.$58l(N)},bi=ag.prototype;bi.$58l=function(r){this.$62l=r,this.points=new Array},bi.$56l=function($){this.points.push($)},bi.$57l=function(H){this.points=this.points.concat(H)};var Bm=function(u,Q){arguments.length>0&&this.$58l(u,Q)},fn=Bm.prototype;fn.$58l=function(I,u){this.x=I,this.y=u},fn.add=function(C){return new Bm(this.x+C.x,this.y+C.y)},fn.addEquals=function(p){return this.x+=p.x,this.y+=p.y,this},fn.$55l=function(J){return new Bm(this.x*J,this.y*J)},fn.eq=function(X){return this.x==X.x&&this.y==X.y},fn.lt=function(T){return this.x<T.x&&this.y<T.y},fn.lte=function(t){return this.x<=t.x&&this.y<=t.y},fn.gt=function(T){return this.x>T.x&&this.y>T.y},fn.gte=function($){return this.x>=$.x&&this.y>=$.y},fn.lerp=function(d,r){return new Bm(this.x+(d.x-this.x)*r,this.y+(d.y-this.y)*r)},fn.distanceFrom=function(K){var Q=this.x-K.x,E=this.y-K.y;return R(Q*Q+E*E)},fn.min=function(I){return new Bm(_(this.x,I.x),_(this.y,I.y))},fn.max=function(D){return new Bm(P(this.x,D.x),P(this.y,D.y))},fn.toString=function(){return this.x+","+this.y};var Tf=function(){this.$58l(arguments)},xe=Tf.prototype;Tf.TO=1e-6,Tf.AC=6,xe.$58l=function(D){this.co=new Array;for(var o=D.length-1;o>=0;o--)this.co.push(D[o])},xe.$55l=function(K){for(var u=new Tf,c=0;c<=this.$50l()+K.$50l();c++)u.co.push(0);for(var c=0;c<=this.$50l();c++)for(var B=0;B<=K.$50l();B++)u.co[c+B]+=this.co[c]*K.co[B];return u},xe.$59l=function(){for(var P=this.$50l();P>=0&&d(this.co[P])<=Tf.TO;P--)this.co.pop()},xe.$50l=function(){return this.co.length-1},xe.$51l=function(){var l;switch(this.$59l(),this.$50l()){case 0:l=new Array;break;case 1:l=this.$52l();break;case 2:l=this.$53l();break;case 3:l=this.$54l();break;case 4:l=this.$63l();break;default:l=new Array}return l},xe.$52l=function(){var D=new Array,m=this.co[1];return 0!=m&&D.push(-this.co[0]/m),D},xe.$53l=function(){var Q=new Array;if(2==this.$50l()){var S=this.co[2],c=this.co[1]/S,o=this.co[0]/S,b=c*c-4*o;if(b>0){var L=R(b);Q.push(.5*(-c+L)),Q.push(.5*(-c-L))}else 0==b&&Q.push(.5*-c)}return Q},xe.$63l=function(){var G=new Array;if(4==this.$50l()){var N=this.co[4],k=this.co[3]/N,o=this.co[2]/N,s=this.co[1]/N,b=this.co[0]/N,u=new Tf(1,-o,k*s-4*b,-k*k*b+4*o*b-s*s).$54l(),Q=u[0],H=k*k/4-o+Q;if(d(H)<=Tf.TO&&(H=0),H>0){var m=R(H),Y=3*k*k/4-m*m-2*o,M=(4*k*o-8*s-k*k*k)/(4*m),B=Y+M,z=Y-M;if(d(B)<=Tf.TO&&(B=0),d(z)<=Tf.TO&&(z=0),B>=0){var C=R(B);G.push(-k/4+(m+C)/2),G.push(-k/4+(m-C)/2)}if(z>=0){var C=R(z);G.push(-k/4+(C-m)/2),G.push(-k/4-(C+m)/2)}}else if(0>H);else{var M=Q*Q-4*b;if(M>=-Tf.TO){if(0>M&&(M=0),M=2*R(M),Y=3*k*k/4-2*o,Y+M>=Tf.TO){var x=R(Y+M);G.push(-k/4+x/2),G.push(-k/4-x/2)}if(Y-M>=Tf.TO){var x=R(Y-M);G.push(-k/4+x/2),G.push(-k/4-x/2)}}}}return G},xe.$54l=function(){var n=new Array;if(3==this.$50l()){var $=this.co[3],K=this.co[2]/$,q=this.co[1]/$,Z=this.co[0]/$,B=(3*q-K*K)/3,m=(2*K*K*K-9*q*K+27*Z)/27,P=K/3,j=m*m/4+B*B*B/27,a=m/2;if(d(j)<=Tf.TO&&(j=0),j>0){var C,V,S=R(j);C=-a+S,V=C>=0?k(C,1/3):-k(-C,1/3),C=-a-S,C>=0?V+=k(C,1/3):V-=k(-C,1/3),n.push(V-P)}else if(0>j){var p=R(-B/3),X=r(R(-j),-a)/3,y=M(X),v=c(X),J=R(3);n.push(2*p*y-P),n.push(-p*(y+J*v)-P),n.push(-p*(y-J*v)-P)}else{var C;C=a>=0?-k(a,1/3):k(-a,1/3),n.push(2*C-P),n.push(-C-P)}}return n};var wn=function(R,B){arguments.length>0&&this.$58l(R,B)},js=wn.prototype;js.$58l=function(O,B){this.x=O,this.y=B},js.length=function(){return R(this.x*this.x+this.y*this.y)},js.$60l=function(k){return this.x*k.x+this.y*k.y};var Gf=function(j,P,w,m){var C,S=(m.x-w.x)*(j.y-w.y)-(m.y-w.y)*(j.x-w.x),R=(P.x-j.x)*(j.y-w.y)-(P.y-j.y)*(j.x-w.x),n=(m.y-w.y)*(P.x-j.x)-(m.x-w.x)*(P.y-j.y);if(0!=n){var d=S/n,D=R/n;d>=0&&1>=d&&D>=0&&1>=D?(C=new ag(p),C.points.push(new Bm(j.x+d*(P.x-j.x),j.y+d*(P.y-j.y)))):C=new ag(K)}else C=0==S||0==R?new ag("C"):new ag("P");return C},Rf=function(D,u,o,l,s){var m,X,O,N,M,E,d,G=l.min(s),v=l.max(s),Y=new ag(K);m=u.$55l(-2),O=D.add(m.add(o)),m=D.$55l(-2),X=u.$55l(2),N=m.add(X),M=new Bm(D.x,D.y),d=new wn(l.y-s.y,s.x-l.x),E=l.x*s.y-s.x*l.y;for(var H=new Tf(d.$60l(O),d.$60l(N),d.$60l(M)+E).$51l(),A=0;A<H.length;A++){var C=H[A];if(C>=0&&1>=C){var U=D.lerp(u,C),t=u.lerp(o,C),e=U.lerp(t,C);l.x==s.x?G.y<=e.y&&e.y<=v.y&&(Y.$62l=p,Y.$56l(e)):l.y==s.y?G.x<=e.x&&e.x<=v.x&&(Y.$62l=p,Y.$56l(e)):e.gte(G)&&e.lte(v)&&(Y.$62l=p,Y.$56l(e))}}return Y},Vb=function(y,h,a,$,O){var M=$.min(O),L=$.max(O),l=new Bm(L.x,M.y),d=new Bm(M.x,L.y),C=Rf(y,h,a,M,l),j=Rf(y,h,a,l,L),g=Rf(y,h,a,L,d),x=Rf(y,h,a,d,M),G=new ag(K);return G.$57l(C.points),G.$57l(j.points),G.$57l(g.points),G.$57l(x.points),G.points.length>0&&(G.$62l=p),G},_b=function(r,X,l,H,N,t){var o,R,v,b,s,E,u,O,h,q,L=N.min(t),w=N.max(t),g=new ag(K);o=r.$55l(-1),R=X.$55l(3),v=l.$55l(-3),b=o.add(R.add(v.add(H))),s=new wn(b.x,b.y),o=r.$55l(3),R=X.$55l(-6),v=l.$55l(3),b=o.add(R.add(v)),E=new wn(b.x,b.y),o=r.$55l(-3),R=X.$55l(3),v=o.add(R),u=new wn(v.x,v.y),O=new wn(r.x,r.y),q=new wn(N.y-t.y,t.x-N.x),h=N.x*t.y-t.x*N.y;for(var B=new Tf(q.$60l(s),q.$60l(E),q.$60l(u),q.$60l(O)+h).$51l(),V=0;V<B.length;V++){var $=B[V];if($>=0&&1>=$){var T=r.lerp(X,$),n=X.lerp(l,$),J=l.lerp(H,$),A=T.lerp(n,$),I=n.lerp(J,$),c=A.lerp(I,$);N.x==t.x?L.y<=c.y&&c.y<=w.y&&(g.$62l=p,g.$56l(c)):N.y==t.y?L.x<=c.x&&c.x<=w.x&&(g.$62l=p,g.$56l(c)):c.gte(L)&&c.lte(w)&&(g.$62l=p,g.$56l(c))}}return g},Tg=function(F,I,e,f,x,A){var l=x.min(A),Q=x.max(A),s=new Bm(Q.x,l.y),r=new Bm(l.x,Q.y),t=_b(F,I,e,f,l,s),$=_b(F,I,e,f,s,Q),X=_b(F,I,e,f,Q,r),g=_b(F,I,e,f,r,l),H=new ag(K);return H.$57l(t.points),H.$57l($.points),H.$57l(X.points),H.$57l(g.points),H.points.length>0&&(H.$62l=p),H},ck=function(Q,R,z,X){var d=z.min(X),r=z.max(X),q=new Bm(r.x,d.y),A=new Bm(d.x,r.y),u=Gf(d,q,Q,R),E=Gf(q,r,Q,R),H=Gf(r,A,Q,R),f=Gf(A,d,Q,R),B=new ag(K);return B.$57l(u.points),B.$57l(E.points),B.$57l(H.points),B.$57l(f.points),B.points.length>0&&(B.$62l=p),B},Nc=v.XEditInteractor=function(z){var e=this,P=e._view=document.createElement("canvas");P.className="editCanvas",P.style.position="absolute",Nc.superClass.constructor.call(e,z)};h.def(Nc,v.Interactor,{ms_edit:1,setUp:function(){var Z=this,F=Z.gv,C=F.getView(),B=Z._view;Nc.superClass.setUp.call(Z),F.setEditInteractor(Z),F.$14l=B,F._79O?C.insertBefore(B,F._79O):C.appendChild(B);var c=Z.$49l=Z.$11l.bind(Z);F.dm().md(c),F.sm().ms(c),F.mp(c)},tearDown:function(){var u=this,r=u.gv,H=r.getView(),k=u.$49l;Nc.superClass.tearDown.call(u),r.setEditInteractor(l),r.$14l=l,H.removeChild(u._view),r.dm().umd(k),r.sm().ums(k),r.ump(k)},clear:function(){var z=this,Q=z.gv;delete z._hoverSegmentIndex,delete z._edge,delete z._shape,delete Q._editing,delete z.$10l,delete z.$13l,delete z.$9l,delete z._removePointIndex,delete z._lp,z.$12l="",delete z.$40l,delete z.$67l,delete z.$72l,delete z.$73l,delete z.$75l,delete z.$1l,delete z.$3l,delete z.$2l,delete z.$92l,delete z.$93l,delete z.$94l,z.clearDragging()},handle_keydown:function(S){this.$48l!==S.shiftKey&&(this.$48l=S.shiftKey,this.handle_mousemove(S,a,!0))},handle_keyup:function(o){this.$48l!==o.shiftKey&&(this.$48l=o.shiftKey,this.handle_mousemove(o,a,!0))},handle_touchstart:function(e){this.handle_mousemove(e),this.handle_mousedown(e)},handle_mousedown:function(x){z(x);var e=this,d=e.$13l,_=e.gv,D=_.dm(),l=D.getHistoryManager(),N=_.sm(),c=_.getZoom(),$=_.lp(x),C=h.isDoubleClick(x),G=h.isLeftButton(x),s=e.$7l,Y=e._shape,R=e._hoverSegmentIndex,m=e._edge,i=e.$87l,T=e.$88l,y=function(){e._68I||i===e.$87l&&T===e.$88l||e.$43l()};if(7!==e.$67l&&(delete e.$87l,delete e.$88l),G&&(Y||m)&&R>=0&&C&&(Y&&N.contains(Y)||m&&N.contains(m))){var k=Cb.call(e,Y||m,R,$);return e.addShapePoint(Y||m,R,k),w(function(){e.handle_mousemove(x)},40),void 0}if(G&&(Y||m)&&e._removePointIndex>=0&&C)return e.removeShapePoint(),e.$5l=1,w(function(){e.handle_mousemove(x)},40),void 0;if(!G||!_._editing)return y(),void 0;if(Y&&d>=0){var p=Y.getPoints().get(d),K=Y.p(),o=ib(K,p.x-K.x,p.y-K.y,-s+Y.getRotation());H=ib(K,$.x-K.x,$.y-K.y,-s),e.$24l={x:H.x-o.x,y:H.y-o.y},e.startDragging(x),l&&l.beginInteraction(),e.fi({kind:"beginEditPoint",event:x,data:Y,index:d}),e.$88l=d,e.$87l=Y}else if(e.$10l){var M=_.sm().getSelection(),V=e.$6l,O=e.$1l={},I=e.$3l={},j=e.$16l[E[e.$10l]],b={x:V.x,y:V.y},S={x:V.x+V.width/2,y:V.y+V.height/2};e.$24l={x:$.x-j.x/c,y:$.y-j.y/c},e.$2l=g(e.$8l),e.$4l=g(V),M.each(function(D){if(D instanceof A){var c=D.p(),U=D.getWidth(),e=D.getHeight(),y=ib(S,c.x-S.x,c.y-S.y,-s);O[D.getId()]={x:c.x-U/2,y:c.y-e/2,width:U,height:e},I[D.getId()]={x:(y.x-b.x)/V.width,y:(y.y-b.y)/V.height}}}),e.startDragging(x),l&&l.beginInteraction(),e.fi({kind:"beginEditRect",event:x,direction:e.$10l})}else if(m&&d>=0){var t=vn(_.getDataUI(m),m.s("edge.points")),p=t.get(d);e.$24l={x:$.x-p.x,y:$.y-p.y},e.startDragging(x),l&&l.beginInteraction(),e.fi({kind:"beginEditPoint",event:x,data:m,index:d}),e.$88l=d,e.$87l=m}else if(e.$40l){var V=e.$6l,S={x:V.x+V.width/2,y:V.y+V.height/2},f=g(e.$23l);f.x/=c,f.y/=c;var u=ib(S,f.x-S.x,f.y-S.y,-s),H=ib(S,$.x-S.x,$.y-S.y,-s);e.$24l={x:H.x-u.x,y:H.y-u.y},e.startDragging(x),l&&l.beginInteraction(),e.fi({kind:"beginEditRotation",event:x,data:e._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(e.$67l)>=0)e.startDragging(x);else if(e.$71l&&C&&e.$79l(e.$71l,$)){var P=N.toSelection();l&&l.beginInteraction(),P.each(function(H){D.remove(H)}),l&&l.endInteraction()}y()},$11l:function(){var $=this,m=$.gv;m._editing&&($.$13l==l||$._shape==l&&$._edge==l)&&($.$73l==l||1!==$.$67l&&5!==$.$67l&&6!==$.$67l)||($.$5l=1),$._68I=1},$46l:function(v){var T=this,q=T.gv,V=q.lp(v),s=[];return yi(q,function(E){var e=q.getDataUI(E);if(e){var v=e._79o();O(v,V)&&s.push(E)}}),s},$47l:function(d){var p=this,P=p.$13l,G=p.gv.dm(),D=G.getHistoryManager();p.$10l?(p.fi({kind:"endEditRect",event:d,direction:p.$10l}),D&&D.endInteraction()):p._shape&&P>=0?(p.fi({kind:"endEditPoint",event:d,data:p._shape,index:P}),D&&D.endInteraction()):p._edge&&P>=0?(p.fi({kind:"endEditPoint",event:d,data:p._edge,index:P}),D&&D.endInteraction()):p.$23l&&p.$40l&&(p.fi({kind:"endEditRotation",event:d}),D&&D.endInteraction())},handleWindowTouchEnd:function(L){this.handleWindowMouseUp(L)},handleWindowMouseUp:function($){var U=this,k=U.gv,j=k.dm(),v=j.getHistoryManager(),g=U._shape,b=U._edge,o=U.$13l,i=U.$40l,O=U.$9l,F=U.$10l,X=U.$67l;if((g||b)&&o>=0&&O>=0){var C,M;if(g){var H=g.p(),r=g.getRotation();C=g.getPoints(),M=C.get(O),Ak(g,H,r,o,M,!1)}else if(C=vn(k.getDataUI(b),b.s("edge.points"),!0),M=C.get(O),0===o){var q=C.get(0);b.s("edge.source.offset.x",M.x-q.x),b.s("edge.source.offset.y",M.y-q.y)}else if(o===C.size()-1){var W=C.get(C.size()-1);b.s("edge.target.offset.x",M.x-W.x),b.s("edge.target.offset.y",M.y-W.y)}else"points"===b.s("edge.type")&&(C.set(o,M),b.s("edge.points",Lr(C)))}U.$47l($);var x=U.$73l;1===X?(v&&v.beginInteraction(),x?k.sm().each(function(g){if(g.setHost&&k.isHelperEditable(g,"host")){g.setHost(x);var r=U.$75l,Q=U.$74l;r&&(g.s("attach.row.index",r.rowIndex),g.s("attach.column.index",r.columnIndex)),Q&&(g.s("attach.index",Q.attachIndex),g.s("attach.offset",Q.attachOffset),g.s("attach.offset.relative",!1),g.s("attach.offset.opposite",!1))
}}):k.sm().each(function(E){E.setHost&&k.isHelperEditable(E,"host")&&(E.setHost(l),E.s("attach.row.index",a),E.s("attach.column.index",a),E.s("attach.index",a),E.s("attach.offset",a),E.s("attach.offset.relative",!1),E.s("attach.offset.opposite",!1))}),v&&v.endInteraction()):2===X?(v&&v.beginInteraction(),x?k.sm().each(function(v){v.setParent&&k.isHelperEditable(v,"parent")&&v.setParent(x)}):k.sm().each(function(W){W.setParent&&k.isHelperEditable(W,"parent")&&W.setParent(l)}),v&&v.endInteraction()):3===X?x&&(v&&v.beginInteraction(),k.sm().each(function(L){if(k.isHelperEditable(L,"edge")&&L instanceof A&&x instanceof A){var Y=new B.Edge;j.add(Y),Y.setSource(L),Y.setTarget(x),U.onEdgeCreated&&U.onEdgeCreated($,Y)}}),v&&v.endInteraction()):(5===X||6===X)&&x&&(v&&v.beginInteraction(),k.sm().each(function(N){N instanceof f&&x instanceof A&&(5===X&&k.isHelperEditable(N,"source")?N.setSource(x):6===X&&k.isHelperEditable(N,"source")&&N.setTarget(x))}),v&&v.endInteraction()),(F||i)&&U.$43l(!0),G?(U.clear(),delete U.$64l,U._68I||U.$43l()):(U.handle_mousemove($,!0),X&&!U._68I&&U.$43l())},handleWindowTouchMove:function(p){this.handleWindowMouseMove(p)},handleWindowMouseMove:function(J){this._78I(J)},handle_mousemove:function(D,f,v){if(!this._pause){if(!v){var F=G?Jn(D):D;this.$61l={clientX:F.clientX,clientY:F.clientY}}if(f===!0||!U()){var y=this,Z=y.gv,A=!1,k=l;y.clear(),Z.sm().size()>0&&(k=Z.lp(v?y.$61l:D),A=y._79I(D,k)),A&&(Z._editing=1),y.$12l!==y.$65l&&(y.$65l=y.$12l,y.setCursor(y.$12l)),y.$40l!==y.$64l&&(y.$64l=y.$40l,y._68I||y.$43l()),y._hoverSegmentIndex!==y.$66l&&(y.$66l=y._hoverSegmentIndex,y._68I||y.$43l())}}},_78I:function(k){this.autoScroll(k);var b=this,e=b.gv,y=e.lp(k),N=e.getZoom(),o=b.$13l;if((b._shape||b._edge)&&o>=0){var X,O,_,j=b._shape,K=b._edge,W=b.$24l,U=e.getPointSnapSpacing(),M=function(y,u){return U==l||isNaN(U)?{x:y,y:u}:{x:n(y/U)*U,y:n(u/U)*U}};if(j){X=j.getPoints();var E=j.p(),p=j.getRotation(),g=0;O=ib(E,y.x-E.x,y.y-E.y,-p),Ak(j,E,p,o,y,!0,W,M),b.fi({kind:"betweenEditPoint",event:k,data:j,index:o})}else if(K){X=vn(e.getDataUI(K),K.s("edge.points"),!0),y.x-=W.x,y.y-=W.y,O=y;var C,P;if(0===o){var Q=X.get(0);C=y.x-Q.x,P=y.y-Q.y,_=M(C,P),K.s("edge.source.offset.x",_.x),K.s("edge.source.offset.y",_.y)}else if(o===X.size()-1){var J=X.get(X.size()-1);C=y.x-J.x,P=y.y-J.y,_=M(C,P),K.s("edge.target.offset.x",_.x),K.s("edge.target.offset.y",_.y)}else"points"===K.s("edge.type")&&(_=M(y.x,y.y),_.e=X.get(o).e,X.set(o,_),K.s("edge.points",Lr(X)));b.fi({kind:"betweenEditPoint",event:k,data:K,index:o})}if(delete b.$9l,e.isSnapPoint(j)||e.isSnapPoint(K))for(g=0;g<X.size();g++)if(g!==o){var V=X.get(g);if($(V,O)<e.getEditPointSize()/N){b.$9l=g;break}}}else if(b.$10l){var W=b.$24l;y.x-=W.x,y.y-=W.y;var S=e.sm().getSelection(),G=b.$1l,v=b.$7l,Y=b.$10l,m=b.$4l,x=b.$2l,c=e.getEditRectPadding()/N,D=2*c,B=e.getSnapSpacing(),t=B!=l&&!isNaN(B),i=Uj(x,y,Y,v,2*c,e.getResizeMode(),t,!0),F=b.$6l;if(t){var Z=i.width-D,T=i.height-D,z=n(Z/B)*B,q=n(T/B)*B,H=z-Z,a=q-T;("west"===Y||"northwest"===Y||"southwest"===Y)&&(H=-H),("north"===Y||"northwest"===Y||"northeast"===Y)&&(a=-a),i=Uj(x,y,Y,v,2*c,e.getResizeMode(),t,!1,H,a)}b.$8l=i,F.x=i.x+c,F.y=i.y+c,F.width=i.width-D,F.height=i.height-D;var Ah=i.x+i.width/2,qs=i.y+i.height/2,kh=F.x,_f=F.y,rs=F.width/m.width,Fc=F.height/m.height;S.each(function(U){if(U instanceof A&&e.isEditable(U)&&e.isRectEditable(U)){var S=G[U.getId()],z=b.$3l[U.getId()],l={x:S.x+S.width/2,y:S.y+S.height/2},E=0,a=0,u=Y,j=180*d(v-U.getRotation())/L;"northeast"===Y?j>=315||45>j?(E=S.width*rs+S.x,a=S.height*(1-Fc)+S.y,u="northeast"):j>=45&&135>j?(E=S.width*(1-Fc)+S.x,a=S.height*(1-rs)+S.y,u="northwest"):j>=135&&225>j?(E=S.width*(1-rs)+S.x,a=S.height*Fc+S.y,u="southwest"):(E=S.width*Fc+S.x,a=S.height*rs+S.y,u="southeast"):"north"===Y?j>=315||45>j?(a=S.height*(1-Fc)+S.y,u="north"):j>=45&&135>j?(E=S.width*(1-Fc)+S.x,u="west"):j>=135&&225>j?(a=S.height*Fc+S.y,u="south"):(E=S.width*Fc+S.x,u="east"):"northwest"===Y?j>=315||45>j?(E=S.width*(1-rs)+S.x,a=S.height*(1-Fc)+S.y,u="northwest"):j>=45&&135>j?(E=S.width*(1-Fc)+S.x,a=S.height*rs+S.y,u="southwest"):j>=135&&225>j?(E=S.width*rs+S.x,a=S.height*Fc+S.y,u="southeast"):(E=S.width*Fc+S.x,a=S.height*(1-rs)+S.y,u="northeast"):"west"===Y?j>=315||45>j?(E=S.width*(1-rs)+S.x,u="west"):j>=45&&135>j?(a=S.height*rs+S.y,u="south"):j>=135&&225>j?(E=S.width*rs+S.x,u="east"):(a=S.height*(1-rs)+S.y,u="north"):"southwest"===Y?j>=315||45>j?(E=S.width*(1-rs)+S.x,a=S.height*Fc+S.y,u="southwest"):j>=45&&135>j?(E=S.width*Fc+S.x,a=S.height*rs+S.y,u="southeast"):j>=135&&225>j?(E=S.width*rs+S.x,a=S.height*(1-Fc)+S.y,u="northeast"):(E=S.width*(1-Fc)+S.x,a=S.height*(1-rs)+S.y,u="northwest"):"east"===Y?j>=315||45>j?(E=S.width*rs+S.x,u="east"):j>=45&&135>j?(a=S.height*(1-rs)+S.y,u="north"):j>=135&&225>j?(E=S.width*(1-rs)+S.x,u="west"):(a=S.height*rs+S.y,u="south"):"south"===Y?j>=315||45>j?(a=S.height*Fc+S.y,u="south"):j>=45&&135>j?(E=S.width*Fc+S.x,u="east"):j>=135&&225>j?(a=S.height*(1-Fc)+S.y,u="north"):(E=S.width*(1-Fc)+S.x,u="west"):"southeast"===Y&&(j>=315||45>j?(E=S.width*rs+S.x,a=S.height*Fc+S.y,u="southeast"):j>=45&&135>j?(E=S.width*Fc+S.x,a=S.height*(1-rs)+S.y,u="northeast"):j>=135&&225>j?(E=S.width*(1-rs)+S.x,a=S.height*(1-Fc)+S.y,u="northwest"):(E=S.width*(1-Fc)+S.x,a=S.height*rs+S.y,u="southwest"));var N=ib(l,E-l.x,a-l.y,U.getRotation());Qh(U,S,u,{x:N.x,y:N.y});var t=kh+F.width*z.x,x=_f+F.height*z.y,m={x:t,y:x};m=ib({x:Ah,y:qs},m.x-Ah,m.y-qs,v),U.p(m.x,m.y)}}),b.fi({kind:"betweenEditRect",event:k,direction:Y})}else if(b.$23l&&b.$40l){var $c=b.$8l,vb=$c.width,Cl=$c.height,E={x:$c.x+vb/2,y:$c.y+Cl/2},W=b.$24l,Bg=b.$23l,Oi=Bg.x/N-E.x,qn=Bg.y/N-E.y,dl=R(Oi*Oi+qn*qn),Jg=Math.asin(W.x/dl),zp=e.sm().getSelection(),Vc=I+r(y.y-E.y,y.x-E.x)-Jg,Ol=e.getSnapAngle(),Vc=n(Vc/Ol)*Ol;0>Vc&&(Vc+=s);var $r=Vc-b.$7l,oe=[E.x,0,E.y];zp.each(function(X){if(e.isEditable(X)&&e.isRotationEditable(X)&&e.isVisible(X)){var $=Qm(X.p3(),oe),U=uc();vi(U,-$r),X.setRotation(X.getRotation()+$r),Dp($,U),X.p3(oe[0]+$[0],oe[1]+$[1],oe[2]+$[2])}}),b.$7l=Vc,b.fi({kind:"betweenEditRotation",event:k})}else if([1,2,3,5,6].indexOf(b.$67l)>=0)b.$72l=k,b.$78l||(b.$78l=1,w(function(){h.isDragging()&&b.$43l(),delete b.$78l},12));else if(7===b.$67l){if(b.$87l instanceof u){var j=b.$87l,lg=b.$88l,Db=h.clone(j.getPoints().get(lg)),Li=y.y-Db.y;Db.e||(Db.e=0),b.$92l||(b.$92l=Db.e),Db.e=b.$92l-Li,j.setPoint(lg,Db)}else if(b.$87l instanceof f){var K=b.$87l,lg=b.$88l,X=vn(e.getDataUI(K),K.s("edge.points")),Db=X.get(lg),Li=y.y-Db.y;Db.e||(Db.e=0),b.$92l||(b.$92l=Db.e),Db.e=b.$92l-Li,X.set(lg,Db),K.s("edge.points",Lr(X))}}else if(8===b.$67l){var zp=e.sm().getSelection(),al=b.$93l;al||(al=b.$93l={}),zp.each(function(U){if(U.p3){var _=U.p3(),C=al[U.getId()];C==l&&(C=al[U.getId()]=_[1]),U.p3([_[0],C-(y.y-b.$90l.y/N),_[2]])}})}else if(9===b.$67l){var zp=e.sm().getSelection(),Rm=b.$94l;Rm||(Rm=b.$94l={}),zp.each(function(V){if(V.s3){var _=V.s3(),h=Rm[V.getId()];h==l&&(h=Rm[V.getId()]=_[1]);var x=h-(y.y-b.$91l.y/N);0>x&&(x=.01),V.s3([_[0],x,_[2]])}})}},$79l:function(N,u){var p=this,z=p.gv,K=z.getZoom(),T=z.getEditHelperSize(),k=N.x/K,q=N.y/K,f=T/K,V=f/2;return O({x:k-V,y:q-V,width:f,height:f},u)?!0:void 0},_79I:function(l,L){var a=this,Y=a.gv,e=Y.getZoom(),t=Y.getEditPointSize(),r=t/e,H=r/2;if(a.$16l){var P,q=a.$16l,j=q[3].x-q[7].x,E=q[3].y-q[7].y,N=R(j*j+E*E),K=q[1].x-q[5].x,_=q[1].y-q[5].y,k=R(K*K+_*_),W={x:L.x*e,y:L.y*e};if(a._80I(W,0,q[0],"northwest",N,k)||a._80I(W,1,q[1],"north",N,k)||a._80I(W,2,q[2],"northeast",N,k)||a._80I(W,7,q[7],"west",N,k)||a._80I(W,3,q[3],"east",N,k)||a._80I(W,6,q[6],"southwest",N,k)||a._80I(W,5,q[5],"south",N,k)||a._80I(W,4,q[4],"southeast",N,k))return!0}if(a.$23l){var h=a.$23l,i=h.x/e,F=h.y/e;if(O({x:i-H,y:F-H,width:r,height:r},L))return a.$40l=1,a.$12l="crosshair",!0}if(a.$68l&&a.$79l(a.$68l,L))return a.$67l=1,a.$12l="crosshair",!0;if(a.$69l&&a.$79l(a.$69l,L))return a.$67l=2,a.$12l="crosshair",!0;if(a.$70l&&a.$79l(a.$70l,L))return a.$67l=3,a.$12l="crosshair",!0;if(a.$71l&&a.$79l(a.$71l,L))return a.$67l=4,a.$12l="crosshair",!0;if(a.$82l&&a.$79l(a.$82l,L))return a.$67l=5,a.$12l="crosshair",!0;if(a.$83l&&a.$79l(a.$83l,L))return a.$67l=6,a.$12l="crosshair",!0;if(a._pointElevationHelperPoint&&a.$79l(a._pointElevationHelperPoint,L))return a.$67l=7,a.$12l="crosshair",!0;if(a.$90l&&a.$79l(a.$90l,L))return a.$67l=8,a.$12l="crosshair",!0;if(a.$91l&&a.$79l(a.$91l,L))return a.$67l=9,a.$12l="crosshair",!0;for(var X=a.$46l(l),S=0;S<X.length;S++){var P,V,v=X[S],M=Y.getDataUI(v);if(M&&M._55O){var w=M._55O;if(w._43O&&v instanceof f){if(P=v.s("edge.points"),P=vn(M,P),V=v.s("edge.segments"),V||(V=Nj(P)),a.$42l(v,L,P._as,V,"edge"))return!0;"points"===v.s("edge.type")&&a.$41l(v,L,P._as,V,"edge")}if(w._43O&&v instanceof u&&w.$15l&&w.$15l.length===v.getPoints().size()){if(P=w.$15l,V=v.getSegments(),V||(V=Nj(P)),a.$42l(v,L,P,V,"shape"))return!0;a.$41l(v,L,P,V,"shape")}}}return!1},_80I:function(b,f,N,z,m,T){var t=this,J=t.gv,o=J.getEditPointSize(),P=o/2,H=J.sm(),j=J.isDirectionEditable;if(j&&1===H.size()){var y=H.ld();if(j=j.bind(J),y instanceof A){if(!j(y,z))return!1;if("east"===z){if(j(y,"northeast")&&j(y,"southeast")&&2*o>=T)return!1}else if("west"===z){if(j(y,"northwest")&&j(y,"southwest")&&2*o>=T)return!1}else if("north"===z){if(j(y,"northwest")&&j(y,"northeast")&&2*o>=m)return!1}else if("south"===z&&j(y,"southwest")&&j(y,"southeast")&&2*o>=m)return!1}}else{if(2*o>=m&&("north"===z||"south"===z))return!1;if(2*o>=T&&("east"===z||"west"===z))return!1}if(O({x:N.x-P,y:N.y-P,width:o,height:o},b)){if(t.$10l!==z){var g=180*t.$7l/L,Y="";g>=337.5||22.5>g?Y="north":g>=22.5&&67.5>g?Y="northeast":g>=67.5&&112.5>g?Y="east":g>=112.5&&157.5>g?Y="southeast":g>=157.5&&202.5>g?Y="south":g>=202.5&&247.5>g?Y="southwest":g>=247.5&&292.5>g?Y="west":g>=292.5&&337.5>g&&(Y="northwest");var e=rd.indexOf(Y),Y=rd[f-(1-e)+8];switch(Y){case"northwest":t.$12l="nwse-resize";break;case"northeast":t.$12l="nesw-resize";break;case"southwest":t.$12l="nesw-resize";break;case"southeast":t.$12l="nwse-resize";break;case"north":t.$12l="ns-resize";break;case"east":t.$12l="ew-resize";break;case"south":t.$12l="ns-resize";break;case"west":t.$12l="ew-resize"}t.$10l=z}return!0}return!1},$42l:function(y,Z,b,c,l){var U,E=this,z=E.gv,r=z.getEditPointSize(),M=r/z.getZoom(),D=-1,J={x:Z.x,y:Z.y,width:0,height:0},g=function(w){"shape"===l?E._shape=y:E._edge=y,E._removePointIndex=w},K=function(g){"shape"===l?E._shape=y:E._edge=y,E.$13l=g,E.$12l="crosshair"};for(V(J,M/2),D=b.length-1,U=c.size()-1;U>=0;U--){var a=c.get(U);if(1===a||2===a)D-=1;else if(3===a){var G=b[D-1];if(O(J,G))return K(D-1),!0;D-=2}else if(4===a){var W=b[D-1],f=b[D-2];if(O(J,W))return K(D-1),!0;if(O(J,f))return K(D-2),!0;D-=3}}for(D=b.length-1,U=c.size()-1;U>=0;U--){var a=c.get(U),k=b[D];if(O(J,k))return g(D),K(D),!0;1===a||2===a?D-=1:3===a?D-=2:4===a&&(D-=3)}return!1},$41l:function(Z,$,k,t,X){var O=this,q=O.gv,h=-1,N=0,K={x:$.x,y:$.y,width:0,height:0},R=function(u,n){O._hoverSegmentIndex=n,O._lp=$,"shape"===X?O._shape=Z:O._edge=Z};for(V(K,q.getSegmentHoverWidth()/2/q.getZoom()),Z instanceof u&&Z.isClosePath()&&t.indexOf(5)<0&&(t=new o(t._as),t.add(5));N<t.size();N++){var B=t.get(N);if(1===B){var S=k[h],I=k[h+1];if(S){var n=ck(new Bm(S.x,S.y),new Bm(I.x,I.y),new Bm(K.x,K.y),new Bm(K.x+K.width,K.y+K.height));if(n.$62l===p&&n.points.length>0)return R(n,N),!0}h+=1}else if(2===B){var S=k[h],I=k[h+1],n=ck(new Bm(S.x,S.y),new Bm(I.x,I.y),new Bm(K.x,K.y),new Bm(K.x+K.width,K.y+K.height));if(n.$62l===p&&n.points.length>0)return R(n,N),!0;h+=1}else if(3===B){var S=k[h],P=k[h+1],H=k[h+2],n=Vb(new Bm(S.x,S.y),new Bm(P.x,P.y),new Bm(H.x,H.y),new Bm(K.x,K.y),new Bm(K.x+K.width,K.y+K.height));if(n.$62l===p)return R(n,N),!0;h+=2}else if(4===B){var S=k[h],C=k[h+1],D=k[h+2],H=k[h+3],n=Tg(new Bm(S.x,S.y),new Bm(C.x,C.y),new Bm(D.x,D.y),new Bm(H.x,H.y),new Bm(K.x,K.y),new Bm(K.x+K.width,K.y+K.height));if(n.$62l===p)return R(n,N),!0;h+=3}else if(5===B){var S=k[h],I=k[0];if(S){var n=ck(new Bm(S.x,S.y),new Bm(I.x,I.y),new Bm(K.x,K.y),new Bm(K.x+K.width,K.y+K.height));if(n.$62l===p&&n.points.length>0)return R(n,N),!0}}}return!1},addShapePoint:function(R,S,W){var c=this,L=c.gv,x=L.dm(),w=x.getHistoryManager();if(w&&w.beginInteraction(),0===arguments.length&&(R=c._shape||c._edge,S=c._hoverSegmentIndex,W=c._lp),R instanceof u||R instanceof f){var J=Me(R,L.getDataUI(R),S);if(!isNaN(S)&&W&&!isNaN(J)){var i=W;if(R instanceof u){var k=R.p(),X=R.getRotation(),H=R.toSegments();H||(H=Nj(R.getPoints())),R.isClosePath()&&H.indexOf(5)<0&&(H=new o(H._as),H.add(5));var G=H.get(S),d="addPoint",P="removePointAt";if(2===G||1===G){var b={x:i.x,y:i.y};H.add(G,S),b=ib(k,b.x-k.x,b.y-k.y,-X),R[d](b,J+1)}else if(3===G){var M=R.getPoints(),m=M.get(J),y=M.get(J+2),b={x:i.x,y:i.y};b=ib(k,b.x-k.x,b.y-k.y,-X);var r=Vo(m,b),e=Vo(b,y);H.removeAt(S),H.add(3,S),H.add(3,S),R.setPoint(J+1,b),R[d](e,J+2),R[d](r,J+1)}else if(4===G){var M=R.getPoints(),m=M.get(J),y=M.get(J+3),b={x:i.x,y:i.y};b=ib(k,b.x-k.x,b.y-k.y,-X);var r=Rb(m,b),e=xq(m,b),N=Rb(b,y),K=xq(b,y);H.removeAt(S),H.add(4,S),H.add(4,S),R[P](J+1),R[P](J+1),R[d](b,J+1),R[d](K,J+2),R[d](N,J+2),R[d](e,J+1),R[d](r,J+1)}else if(5===G){var b={x:i.x,y:i.y};H.add(2,S),b=ib(k,b.x-k.x,b.y-k.y,-X),R[d](b,J+1)}R.isClosePath()&&H.remove(5),R.setSegments(H);var B=R.getWidth(),V=R.getHeight(),Z=R.p().x-B/2,C=R.p().y-V/2;Z-=k.x,C-=k.y;var v=ws(R,{x:Z,y:C,width:B,height:V},X,k);R.p(v.x,v.y)}else if(R instanceof f){if("points"!==R.s("edge.type"))return w&&w.endInteraction(),void 0;var M=R.s("edge.points");H=R.s("edge.segments"),M=vn(L.getDataUI(R),M),H||(H=Nj(M)),H=new o(H._as.slice(0)),M=new o(M._as.slice(0));var G=H.get(S);if(2===G||1===G){var b={x:i.x,y:i.y};H.add(G,S),M.add(b,J+1)}else if(3===G){var m=M.get(J),y=M.get(J+2),b={x:i.x,y:i.y},r=Vo(m,b),e=Vo(b,y);H.removeAt(S),H.add(3,S),H.add(3,S),M.set(J+1,b),M.add(e,J+2),M.add(r,J+1)}else if(4===G){var m=M.get(J),y=M.get(J+3),b={x:i.x,y:i.y},r=Rb(m,b),e=xq(m,b),N=Rb(b,y),K=xq(b,y);H.removeAt(S),H.add(4,S),H.add(4,S),M.removeAt(J+1),M.removeAt(J+1),M.add(b,J+1),M.add(K,J+2),M.add(N,J+2),M.add(e,J+1),M.add(r,J+1)}R.s("edge.points",Lr(M)),R.s("edge.segments",H)}}}w&&w.endInteraction()},removeShapePoint:function(U,p){var X=this,g="removeAt",l=X.gv,z=l.dm(),Z=z.getHistoryManager();if(Z&&Z.beginInteraction(),0===arguments.length&&(U=X._shape||X._edge,p=X._removePointIndex),p>=0&&(U instanceof u||U instanceof f)){var W=Rg(U,X.gv.getDataUI(U),p),d=p;if(U instanceof u){var $=U.p(),q=U.toSegments();q||(q=Nj(U.getPoints()));var E=q.get(W),F="removePointAt";if(1===E&&0===d)if(U.getPoints().size()>1){var c=q.get(W+1);q[g](W+1),3===c?U[F](d+1):4===c&&(U[F](d+2),U[F](d+1)),U[F](d)}else U.dm().remove(U);else 2===E||1===E?(q[g](W),U[F](d)):3===E?(q[g](W),U[F](d),U[F](d-1)):4===E&&(q[g](W),U[F](d),U[F](d-1),U[F](d-2));U.setSegments(q);var _=U.getWidth(),S=U.getHeight(),B=U.p().x-_/2,j=U.p().y-S/2;B-=$.x,j-=$.y;var N=ws(U,{x:B,y:j,width:_,height:S},U.getRotation(),$);U.p(N.x,N.y)}else if(U instanceof f){if("points"!==U.s("edge.type"))return Z&&Z.endInteraction(),void 0;var Y=U.s("edge.points");if(q=U.s("edge.segments"),Y&&(Y=vn(X.gv.getDataUI(U),Y),q||(q=Nj(Y))),0===p||p===Y.size()-1)return Z&&Z.endInteraction(),void 0;q=new o(q._as.slice(0)),Y=new o(Y._as.slice(0));var E=q.get(W);2===E||1===E?(q[g](W),Y[g](d)):3===E?(q[g](W),Y[g](d),Y[g](d-1)):4===E&&(q[g](W),Y[g](d),Y[g](d-1),Y[g](d-2)),U.s("edge.segments",q),U.s("edge.points",Lr(Y))}}Z&&Z.endInteraction()},changeShapeSegment:function(L,B,y){var I=this,$=I.gv,C=$.dm(),p=C.getHistoryManager();if(p&&p.beginInteraction(),1!==arguments.length||isNaN(L)||(y=L,L=I._shape||I._edge,B=I._hoverSegmentIndex),L instanceof u||L instanceof f){var Y=Me(L,I.gv.getDataUI(L),B);if(!isNaN(B)&&!isNaN(Y))if(L instanceof u){var w=L.p(),j=L.toSegments();j||(j=Nj(L.getPoints()));var i=j.get(B),H=L.toPoints();if(1===y||2===y)1===i||2===i?j.set(B,y):3===i?(j.set(B,y),H.removeAt(Y+1)):4===i&&(j.set(B,y),H.removeAt(Y+1),H.removeAt(Y+1));else if(3===y){var F=function(){var M=H.get(Y),b=H.get(Y+1),_=Vo(M,b);j.set(B,3),H.add(_,Y+1)};2===i||1===i?F():4===i&&(H.removeAt(Y+1),H.removeAt(Y+1),F())}else if(4===y){var z=function(){var I=H.get(Y),m=H.get(Y+1),x=Rb(I,m),k=xq(I,m);j.set(B,4),H.add(x,Y+1),H.add(k,Y+2)};2===i||1===i?z():3===i&&(H.removeAt(Y+1),z())}L.setSegments(j),L.setPoints(H);var h=L.getWidth(),m=L.getHeight(),V=L.p().x-h/2,G=L.p().y-m/2;V-=w.x,G-=w.y;var n=new ws(L,{x:V,y:G,width:h,height:m},L.getRotation(),w);L.p(n.x,n.y)}else if(L instanceof f){if("points"!==L.s("edge.type"))return p&&p.endInteraction(),void 0;var H=L.s("edge.points");j=L.s("edge.segments"),H&&(H=vn(I.gv.getDataUI(L),H),j||(j=Nj(H))),j=new o(j._as.slice(0)),H=new o(H._as.slice(0));var i=j.get(B);if(1===y||2===y)1===i||2===i?j.set(B,y):3===i?(j.set(B,y),H.removeAt(Y+1)):4===i&&(j.set(B,y),H.removeAt(Y+1),H.removeAt(Y+1));else if(3===y){var F=function(){var k=H.get(Y),P=H.get(Y+1),E=Vo(k,P);j.set(B,3),H.add(E,Y+1)};2===i||1===i?F():4===i&&(H.removeAt(Y+1),H.removeAt(Y+1),F())}else if(4===y){var z=function(){var G=H.get(Y),b=H.get(Y+1),L=Rb(G,b),k=xq(G,b);j.set(B,4),H.add(L,Y+1),H.add(k,Y+2)};2===i||1===i?z():3===i&&(H.removeAt(Y+1),z())}L.s("edge.points",Lr(H)),L.s("edge.segments",j)}}p&&p.endInteraction()},getDefaultSegments:function(h){var $=this.gv,e=$.getDataUI(h);if(h instanceof f){var L=h.s("edge.points");return L=vn(e,L),Nj(L)}if(h instanceof u){var L=h.getPoints(),E=h.getSegments();return E&&E.size()>0?E:Nj(L)}},$43l:function(x){var k=this;x&&(k.$5l=1),k._68I=1,k._42()},_42:function(){var n=this;if(n._68I){delete n._68I;var Z=n.gv,M=n.$5l,c=Z.getZoom(),G=Z.getEditPointSize(),P=G/2,$=new o,H=n._view,Q=n._edge,S=n._shape,p=H.getContext("2d"),v=Z.tx(),E=Z.ty(),m=l,C=Z.getEditPointBackground(),O=Z.getControlPointBackground(),r=Z.getControlPointBorderColor(),j=Z.getEditPointBorderColor(),N=Z.getEditRectBorderColor(),w=Z.getDirectionLineColor(),b=Z.getSegmentHoverColor(),K=Z.getSnapPointBorderColor(),W=Z.getJoinPointBackground(),t=Z.getJoinPointBorderColor(),a=Z.getSegmentHoverWidth(),I=[5,5],i=Z.getEditRectBorderStyle();sm(Z,function(U){Z.isSelected(U)&&Z.isVisible(U)&&$.add(U)}),p.clearRect(0,0,D(H.width),D(H.height)),p.save(),Y.translateAndScale(p,v,E,1);var L=l,d={x:0,y:0,width:0,height:0},k=0,x=0,z=0,_=0,U=0,T=0,ls=0,Td=0,Kk=0,op=0,_n=[];if(M?(delete n.$6l,delete n.$8l,delete n.$7l,delete n.$16l,delete n.$23l):(L=n.$6l,m=n.$7l),delete n.$68l,delete n.$69l,delete n.$71l,delete n.$70l,delete n.$82l,delete n.$83l,delete n._pointElevationHelperPoint,delete n.$90l,delete n.$91l,delete n.$75l,delete n.$74l,$.each(function(F){var n=Z.getDataUI(F);if(n){var H=n._55O;if(Z.isEditable(F))H._56O&&F instanceof A&&x++,_n.push(F),H._42O&&F instanceof A&&k++,Z.isHelperEditable(F,"host")&&_++,Z.isHelperEditable(F,"parent")&&z++,Z.isHelperEditable(F,"remove")&&U++,Z.isHelperEditable(F,"edge")&&T++,Z.isHelperEditable(F,"source")&&ls++,Z.isHelperEditable(F,"target")&&Td++,Z.isHelperEditable(F,"elevation")&&Kk++,Z.isHelperEditable(F,"tall")&&op++;else if(F instanceof J&&F.isExpanded()){var p=!0,D=Z.getEditableFunc();D&&(p=D(F)),p&&(Z.isHelperEditable(F,"host")&&_++,Z.isHelperEditable(F,"parent")&&z++,Z.isHelperEditable(F,"remove")&&U++,Z.isHelperEditable(F,"edge")&&T++,Z.isHelperEditable(F,"source")&&ls++,Z.isHelperEditable(F,"target")&&Td++,Z.isHelperEditable(F,"elevation")&&Kk++,Z.isHelperEditable(F,"tall")&&op++,_n.push(F))}}}),p.beginPath(),p.lineWidth=1,p.strokeStyle=Z.getNodeBorderColor(),_n.forEach(function(i){var _=Z.getDataUI(i),E=_._55O;if(M)if(m==l&&(m=i instanceof f?0:i instanceof J&&i.isExpanded()?0:i.getRotation(),n.$7l=m),L==l){var G,v,x;if(i instanceof J&&i.isExpanded()||i instanceof f){var $=Z.getDataUIBounds(i);v=$.width,x=$.height,G={x:$.x+v/2,y:$.y+x/2}}else G=i.p(),v=i.getWidth(),x=i.getHeight();L={x:G.x,y:G.y,width:0,height:0},d.x=G.x-v/2,d.y=G.y-x/2,d.width=v,d.height=x,L=e(L,d)}else{var G,v,x,P,h=L.x+L.width/2,O=L.y+L.height/2,o={x:h,y:O};if(i instanceof J&&i.isExpanded()||i instanceof f){P=0;var $=Z.getDataUIBounds(i);v=$.width,x=$.height,G={x:$.x+v/2,y:$.y+x/2}}else G=i.p(),v=i.getWidth(),x=i.getHeight(),P=i.getRotation();var r={x:G.x-v/2,y:G.y-x/2,width:v,height:x},D={x:r.x,y:r.y},u={x:r.x+r.width,y:r.y},H={x:r.x,y:r.y+r.height},U={x:r.x+r.width,y:r.y+r.height},D=ib(G,D.x-G.x,D.y-G.y,P),H=ib(G,H.x-G.x,H.y-G.y,P),U=ib(G,U.x-G.x,U.y-G.y,P),u=ib(G,u.x-G.x,u.y-G.y,P),s=-m,N=ib(o,D.x-o.x,D.y-o.y,s),R=ib(o,u.x-o.x,u.y-o.y,s),Y=ib(o,H.x-o.x,H.y-o.y,s),V=ib(o,U.x-o.x,U.y-o.y,s),I=F([N,R,Y,V]);L=e(L,I),L.x-=h,L.y-=O;var g=ws(l,L,m,o);L.x=g.x-L.width/2,L.y=g.y-L.height/2}if(k>1&&Z.isEditable(i)&&Z.isRectEditable(i)&&i instanceof A){var S=i.getRect(),z=E.$45l,a=dp(z[0],c),y=dp(z[2],c),B=dp(z[4],c),C=dp(z[6],c);i.getRotation()?(p.moveTo(a.x,a.y),p.lineTo(y.x,y.y),p.lineTo(B.x,B.y),p.lineTo(C.x,C.y),p.lineTo(a.x,a.y)):p.rect(S.x*c,S.y*c,S.width*c,S.height*c)}}),p.stroke(),$.each(function(U){var A=Z.getDataUI(U);if(A){var q,N,D=A._55O,m=A._78o;if(D&&D._43O&&U instanceof u?(q=D.$15l,N=U.getSegments(),N||(N=Nj(q)),U.isClosePath()&&N.indexOf(5)<0&&(N=new o(N._as),N.add(5))):D&&m&&D._43O&&(q=U.s("edge.points"),N=U.s("edge.segments"),q=vn(A,q),N||(N=Nj(q)),q&&(q=q._as)),q&&N){var E=0,_=N.size(),R=n._hoverSegmentIndex;q=q.slice(0);for(var d=0;d<q.length;d++)q[d]=dp(q[d],c);p.beginPath(),p.strokeStyle=w,p.lineWidth=1,E=0;for(var d=0;_>d;d++){var H=N.get(d);if(1===H||2===H)E++;else if(3===H){var v=q[E-1],I=q[E],i=q[E+1];p.moveTo(v.x,v.y),p.lineTo(I.x,I.y),p.lineTo(i.x,i.y),E+=2}else if(4===H){var v=q[E-1],$=q[E],G=q[E+1],i=q[E+2];p.moveTo(v.x,v.y),p.lineTo($.x,$.y),p.moveTo(G.x,G.y),p.lineTo(i.x,i.y),E+=3}}if(p.stroke(),S===U||Q===U&&"points"===Q.s("edge.type")){p.beginPath(),E=0,p.strokeStyle=b,p.lineWidth=a;for(var d=0;_>d;d++){var H=N.get(d);if(1===H||2===H){if(R===d){var v=q[E-1],i=q[E];p.moveTo(v.x,v.y),p.lineTo(i.x,i.y);break}E++}else if(3===H){if(R===d){var v=q[E-1],I=q[E],i=q[E+1];p.moveTo(v.x,v.y),p.quadraticCurveTo(I.x,I.y,i.x,i.y);break}E+=2}else if(4===H){if(R===d){var v=q[E-1],$=q[E],G=q[E+1],i=q[E+2];p.moveTo(v.x,v.y),p.bezierCurveTo($.x,$.y,G.x,G.y,i.x,i.y);break}E+=3}else if(5===H&&R===d){var v=q[E-1],i=q[0];p.moveTo(v.x,v.y),p.lineTo(i.x,i.y);break}}p.stroke()}p.beginPath(),E=0,p.strokeStyle=t,p.lineWidth=1,p.fillStyle=W;for(var d=0;_>d;d++){var H=N.get(d);if(1===H||2===H){var i=q[E];p.moveTo(i.x+P,i.y),p.arc(i.x,i.y,P,0,s,!0),E++}else if(3===H){var i=q[E+1];p.moveTo(i.x+P,i.y),p.arc(i.x,i.y,P,0,s,!0),E+=2}else if(4===H){var i=q[E+2];p.moveTo(i.x+P,i.y),p.arc(i.x,i.y,P,0,s,!0),E+=3}}p.fill(),p.stroke(),p.beginPath(),E=0,p.strokeStyle=r,p.lineWidth=1,p.fillStyle=O;for(var d=0;_>d;d++){var H=N.get(d);if(1===H||2===H)E++;else if(3===H){var I=q[E];p.moveTo(I.x+P,I.y),p.arc(I.x,I.y,P,0,s,!0),E+=2}else if(4===H){var $=q[E],G=q[E+1];p.moveTo($.x+P,$.y),p.arc($.x,$.y,P,0,s,!0),p.moveTo(G.x+P,G.y),p.arc(G.x,G.y,P,0,s,!0),E+=3}}if(p.fill(),p.stroke(),p.beginPath(),E=0,p.strokeStyle=K,p.lineWidth=2,(S===U||Q===U)&&n.$9l!=l){var i=q[n.$9l];p.moveTo(i.x+P,i.y),p.arc(i.x,i.y,P,0,s,!0),p.stroke()}}}}),L){n.$6l=g(L),V(L,Z.getEditRectPadding()/c);var Po={x:L.x+L.width/2,y:L.y+L.height/2},$e=xj(Po,L.width,L.height,m),wd=$e[0],ol=$e[1],gk=$e[2],Ld=$e[3],Ne=$e[4],Md=$e[5],qr=$e[6],Bn=$e[7];if(wd=dp($e[0],c),ol=dp($e[1],c),gk=dp($e[2],c),Ld=dp($e[3],c),Ne=dp($e[4],c),Md=dp($e[5],c),qr=dp($e[6],c),Bn=dp($e[7],c),n.$8l=L,k>0&&(n.$16l=[wd,Ne,ol,Md,Ld,qr,gk,Bn],p.beginPath(),p.lineWidth=1,p.strokeStyle=N,"dashed"===i&&p.setLineDash&&p.setLineDash(I),p.moveTo(wd.x,wd.y),p.lineTo(ol.x,ol.y),p.lineTo(Ld.x,Ld.y),p.lineTo(gk.x,gk.y),p.lineTo(wd.x,wd.y),p.stroke(),"dashed"===i&&p.setLineDash&&p.setLineDash([])),p.beginPath(),p.lineWidth=1,p.fillStyle=C,p.strokeStyle=j,k>0){var Qh=Md.x-Bn.x,Kl=Md.y-Bn.y,Ll=R(Qh*Qh+Kl*Kl),Qb=Ne.x-qr.x,Xr=Ne.y-qr.y,go=R(Qb*Qb+Xr*Xr),jo=2*G;if(Z.isDirectionEditable&&1===_n.length){var lq=_n[0],Hh=Z.getDataUI(lq),Lc=Hh._55O,yl=Z.isDirectionEditable.bind(Z);if(Lc._42O){var si,xq,zb,Ae;yl(lq,"northwest")&&(si=!0,p.rect(wd.x-P,wd.y-P,G,G)),yl(lq,"northeast")&&(xq=!0,p.rect(ol.x-P,ol.y-P,G,G)),yl(lq,"southwest")&&(zb=!0,p.rect(gk.x-P,gk.y-P,G,G)),yl(lq,"southeast")&&(Ae=!0,p.rect(Ld.x-P,Ld.y-P,G,G)),yl(lq,"north")&&(si&&xq?Ll>jo&&p.rect(Ne.x-P,Ne.y-P,G,G):p.rect(Ne.x-P,Ne.y-P,G,G)),yl(lq,"south")&&(Ae&&zb?Ll>jo&&p.rect(qr.x-P,qr.y-P,G,G):p.rect(qr.x-P,qr.y-P,G,G)),yl(lq,"west")&&(zb&&si?go>jo&&p.rect(Bn.x-P,Bn.y-P,G,G):p.rect(Bn.x-P,Bn.y-P,G,G)),yl(lq,"east")&&(Ae&&xq?go>jo&&p.rect(Md.x-P,Md.y-P,G,G):p.rect(Md.x-P,Md.y-P,G,G))}}else Ll>jo&&(p.rect(Ne.x-P,Ne.y-P,G,G),p.rect(qr.x-P,qr.y-P,G,G)),go>jo&&(p.rect(Md.x-P,Md.y-P,G,G),p.rect(Bn.x-P,Bn.y-P,G,G)),p.rect(wd.x-P,wd.y-P,G,G),p.rect(ol.x-P,ol.y-P,G,G),p.rect(gk.x-P,gk.y-P,G,G),p.rect(Ld.x-P,Ld.y-P,G,G)}if(x>0){var cs=n.$23l=ib(Ne,0,2*-G,m);p.moveTo(cs.x+P,cs.y),p.arc(cs.x,cs.y,P,0,s,!1)}p.fill(),p.stroke(),n.$40l&&n.$44l(p,L,m);var Sk,Ql,Pi=Z.getLeftTopHelpers(),Xf=Z.getRightTopHelpers(),Go=Z.getLeftBottomHelpers(),xl=Z.getRightBottomHelpers(),pn=Z.getEdgeHelpers(),qc=Z.getEditHelperSize(),Yg=qc/2,Zf=function(w,u,k,$){"leftTop"===u?(Sk=L.x*c-qc-P-("h"===$?k*(qc+P):0)-1,Ql=L.y*c-qc-P-("v"===$?k*(qc+P):0)-1):"rightTop"===u?(Sk=(L.x+L.width)*c+P+("h"===$?k*(qc+P):0)+1,Ql=L.y*c-qc-P-("v"===$?k*(qc+P):0)-1):"leftBottom"===u?(Sk=L.x*c-qc-P-("h"===$?k*(qc+P):0)-1,Ql=(L.y+L.height)*c+P+("v"===$?k*(qc+P):0)+1):"rightBottom"===u&&(Sk=(L.x+L.width)*c+P+("h"===$?k*(qc+P):0)+1,Ql=(L.y+L.height)*c+P+("v"===$?k*(qc+P):0)+1);var l=Sk+Yg,K=Ql+Yg,H=(L.x+L.width/2)*c,J=(L.y+L.height/2)*c,C=ib({x:H,y:J},l-H,K-J,m);if("host"===w){if(_>0)return n.$77l(p,m,C),!0}else if("edge"===w){if(T>0)return n.$80l(p,m,C),!0}else if("remove"===w){if(U>0)return _n&&1===_n.length&&_n[0]instanceof f?n.$81l(p,m,{x:H+qc/2+5,y:J}):n.$81l(p,m,C),!0}else if("parent"===w){if(z>0)return _n&&1===_n.length&&_n[0]instanceof f?n.$76l(p,m,{x:H-qc/2-5,y:J}):n.$76l(p,m,C),!0}else if("elevation"===w){if(Kk>0)return n.$85l(p,m,C),!0}else if("tall"===w){if(op>0)return n.$86l(p,m,C),!0}else if("source"===w||"target"===w){var s=_n[0],I=Z.getDataUI(s),v=Zi(I,!0),A=v[0],o=v[1];if(ls&&"source"===w)return n.$84l(p,L,A,!0,s.isLooped(),u,k,$),!0;if(Td&&"target"===w)return n.$84l(p,L,o,!1,s.isLooped(),u,k,$),!0}};if(Pi&&Pi.length>0){var ac=0;Pi.forEach(function(r){Zf(r,"leftTop",ac,Z.getLeftTopHelpersAlign()||"h")&&ac++})}if(Xf&&Xf.length>0){var ac=0;Xf.forEach(function(f){Zf(f,"rightTop",ac,Z.getRightTopHelpersAlign()||"h")&&ac++})}if(Go&&Go.length>0){var ac=0;Go.forEach(function(y){Zf(y,"leftBottom",ac,Z.getLeftBottomHelpersAlign()||"h")&&ac++})}if(xl&&xl.length>0){var ac=0;xl.forEach(function(I){Zf(I,"rightBottom",ac,Z.getRightBottomHelpersAlign()||"h")&&ac++})}if(pn&&pn.length>0&&((ls||Td)&&_n&&1===_n.length&&_n[0]instanceof f?!0:!1)){var ac=0;pn.forEach(function(Z){Zf(Z,"edge",ac,"h")&&ac++})}if(n.$72l){var Zj,Nm=n.$67l,Mf=n.$68l,ai=n.$69l,Ug=(n.$71l,n.$70l),wq=n.$82l,pc=n.$83l;if(1===Nm?Zj=Mf:2===Nm?Zj=ai:3===Nm?Zj=Ug:5===Nm?Zj=wq:6===Nm&&(Zj=pc),Zj){var xi=Z.lp(n.$72l),sd=Z.getDataAt(n.$72l);if(sd&&sd instanceof A){var fq,Oe,ig;if(n.$73l=sd,1===Nm)if(sd instanceof B.Grid)fq=n.$75l=_i(sd,xi);else if(sd instanceof B.Shape){ig=n.$74l=pk(sd,xi);var ym=sd.getPoints();if(ig){var fp=ig.attachIndex,Uq=Me(sd,Z.getDataUI(sd),fp)+1,jm=Uq+1>=ym.size()?0:Uq+1,ro=ym.get(Uq),Fn=ym.get(jm),Qp=sd.p(),Jk=sd.getRotation();ro=ib(Qp,ro.x-Qp.x,ro.y-Qp.y,Jk),Fn=ib(Qp,Fn.x-Qp.x,Fn.y-Qp.y,Jk),p.beginPath(),p.strokeStyle=b,p.lineWidth=a,p.moveTo(ro.x*c,ro.y*c),p.lineTo(Fn.x*c,Fn.y*c),p.stroke()}}fq?Oe=fq.rect:(Oe=h.clone(Z.getDataUIBounds(sd)),h.grow(Oe,2)),p.beginPath(),p.rect(Oe.x*c,Oe.y*c,Oe.width*c,Oe.height*c),p.strokeStyle=1===Nm||4===Nm||6===Nm?y:X,p.lineWidth=2,p.setLineDash&&p.setLineDash([8,8]),p.stroke()}else delete n.$73l;xi.x=xi.x*c,xi.y=xi.y*c;var Xm=tm(Zj.x,Zj.y,xi.x,xi.y),vb=ib(Zj,xi.x-Zj.x,xi.y-Zj.y,-Xm),Wo=vb.x-Zj.x;p.translate(Zj.x,Zj.y),p.rotate(Xm),q.width=Wo,q.height=40;var ye=X;(1===Nm||4===Nm||6===Nm)&&(ye=y),q.comps[0].gradientColor=ye,h.drawImage(p,q,0,-20,Wo,40)}}}if(n.$87l&&Z.sm().contains(n.$87l)){var Ob,sk=n.$87l,Jm=n.$88l,qc=Z.getEditHelperSize(),Yg=qc/2;if(Z.isHelperEditable(sk,"pointElevation"))if(sk instanceof u){var so=sk.getPosition();Ob=h.clone(sk.getPoints().get(Jm)),Ob=ib({x:so.x,y:so.y},Ob.x-so.x,Ob.y-so.y,sk.getRotation()),Ob.x*=c,Ob.y*=c,p.translate(Ob.x,Ob.y),h.drawImage(p,tj,Yg,-Yg,qc,qc),p.translate(-Ob.x,-Ob.y),n._pointElevationHelperPoint={x:Ob.x+qc,y:Ob.y}}else if(sk instanceof f){var Ir=vn(Z.getDataUI(sk),sk.s("edge.points")),Ob=h.clone(Ir.get(Jm));Ob.x*=c,Ob.y*=c,p.translate(Ob.x,Ob.y),h.drawImage(p,tj,Yg,-Yg,qc,qc),p.translate(-Ob.x,-Ob.y),n._pointElevationHelperPoint={x:Ob.x+qc,y:Ob.y}}}p.restore(),n.$5l=0}},$89l:function(L,O,u,g){L.save();var X=this,J=X.gv,t=J.getEditHelperSize(),E=t/2;L.beginPath(),L.translate(u.x,u.y),L.rotate(O),h.drawImage(L,g,-E,-E,t,t),L.restore()},$85l:function(W,E,P){var I=this;I.$90l=P,I.$89l(W,E,P,tj)},$86l:function(A,U,g){var i=this;i.$91l=g,i.$89l(A,U,g,Lp)},$77l:function(Y,r,k){var o=this;o.$68l=k,o.$89l(Y,r,k,x)},$80l:function(W,C,G){var z=this;z.$70l=G,z.$89l(W,C,G,t)},$81l:function(C,l,k){var U=this;U.$71l=k,U.$89l(C,l,k,Wj)},$76l:function(F,D,m){var z=this;z.$69l=m,z.$89l(F,D,m,b)},$84l:function(Y,F,X,W,j){var G,m=this,n=m.gv,A=n.getZoom(),d=n.getEditHelperSize(),u=d/2;X.x*=A,X.y*=A,j&&(W?X.x-=u+5:X.x+=u+5),X.y-=d-2,W?(m.$82l=X,G=lc):(m.$83l=X,G=vo),Y.beginPath(),Y.translate(X.x,X.y),h.drawImage(Y,G,-u,-u,d,d),Y.translate(-X.x,-X.y)},$44l:function(l,V,h){l.save();var X=this.gv.getZoom(),x=R(k(V.width,2)+k(V.height,2))/2*X+10,A=x,C=A+8,p=A+18,a=h,i=V.x+V.width/2,W=V.y+V.height/2;l.translate(i*X,W*X),l.beginPath(),l.strokeStyle="rgb(150, 150, 150)";for(var B=0,b=0,U=0,Y=0,z=0,T=0;360>T;T++)B=T*L/180,0===T%5&&(b=M(B)*A,U=c(B)*A,Y=M(B)*C,z=c(B)*C,l.moveTo(b,U),l.lineTo(Y,z)),0===T%45&&(b=M(B)*A,U=c(B)*A,Y=M(B)*p,z=c(B)*p,l.moveTo(b,U),l.lineTo(Y,z));l.stroke(),l.beginPath(),l.rotate(-I),l.beginPath(),l.fillStyle="rgba(255, 0, 0, 0.1)",l.strokeStyle="rgb(157, 157, 157)",l.moveTo(0,0),l.arc(0,0,p,0,h,!1),l.fill(),l.beginPath(),l.moveTo(0+p,0),l.arc(0,0,p,0,h,!1),l.stroke(),l.rotate(I),l.font="bold 12px Verdana, Arial";var E=20*c(a),e=20*M(a),o=n(180*a/L)+"°";l.textAlign="center",l.textBaseline="middle",l.beginPath();var H=l.measureText("365.°").width;l.fillStyle="white",l.rect(E-H/2,-e-10,H,20),l.fill(),l.beginPath(),l.fillStyle="rgb(79,79,79)",l.fillText(o,E,-e),l.restore()}})}(this,Object);