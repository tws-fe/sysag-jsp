!function(W,u){"use strict";var N="position",t="absolute",U="relative",E="px",d="left",I="right",L="top",f="bottom",i="display",h="none",m="block",e=ht.Default,B=e.getInternal(),z=Math.floor,J=Math.ceil,n=Math.PI,Q=null,k=W.parseInt,D=function(u){return u.getContext("2d")},w=function(){return document},x=function(u){return w().createElement(u)},$=function(){return x("div")},Y=function(){return x("canvas")},C=function(x,G,c){x.style.setProperty(G,c,Q)},K=function(Z,L,C){e.def(ht.widget[Z],L,C)},H=function(o,Q){o.appendChild(Q)},S=function(G,C){G.removeChild(C)},R=function(l,t,h,s){l.addEventListener(t,h,!!s)},X=function(v,h,U,V){v.removeEventListener(h,U,!!V)};ht.widget.RulerFrame=function(L){var Z=this,B=Z._view=$(),e=Z.$1k=Y(),J=Z.$2k=Y(),s=Z.$3k=Y(),b=Z.$4k=Y();Z._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},Z._topRulerConfig={visible:!0},Z._rightRulerConfig={visible:!1},Z._bottomRulerConfig={visible:!1},Z._leftRulerConfig={visible:!0},H(B,e),H(B,s),H(B,J),H(B,b),C(B,N,U),C(B,"box-sizing","border-box"),C(B,"-moz-box-sizing","border-box"),C(e,N,t),C(J,N,t),C(s,N,t),C(b,N,t),Z.$14k=function(){Z.$13k=1,Z.iv()},Z.$15k=function(b){if(Z._topRulerConfig.guideVisible||Z._rightRulerConfig.guideVisible||Z._bottomRulerConfig.guideVisible||Z._leftRulerConfig.guideVisible||Z._defaultRulerConfig.guideVisible||(Z._topRulerConfig.guideTipVisible||Z._rightRulerConfig.guideTipVisible||Z._bottomRulerConfig.guideTipVisible||Z._leftRulerConfig.guideTipVisible||Z._defaultRulerConfig.guideTipVisible)&&Z._component){var K=B.getBoundingClientRect();Z.$16k={x:b.clientX-K.left,y:b.clientY-K.top},Z.$5k()}},Z.setComponent(L)},K("RulerFrame",u,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(v){var p=this,m=p._component,a=p.getView();if(a){if(p._component=v,p.fp("component",m,v),m){var Q=p.getComponentView(m);S(a,Q),X(a,"mousemove",p.$15k),p.removeComponentPropertyChangeListener(m,p.$14k)}if(v){var h=p.getComponentView(v);H(a,h),C(h,N,t),R(a,"mousemove",p.$15k),p.addComponentPropertyChangeListener(v,p.$14k)}}},addComponentPropertyChangeListener:function(d,m){d&&d.mp&&d.mp(m)},removeComponentPropertyChangeListener:function(u,n){u&&u.ump&&u.ump(n)},getComponentHZoom:function(X){return X&&X.getZoom?X.getZoom():1},getComponentVZoom:function(G){return G&&G.getZoom?G.getZoom():1},getComponentViewRect:function(t){return t&&t.getViewRect?t.getViewRect():void 0},getComponentView:function(r){return r&&r.getView?r.getView():r},invalidateComponent:function(P){P&&P.iv&&P.iv()},validateComponent:function(n){n&&n.validate&&n.validate()},$7k:function(K,U,E,V,L,a,d,F,p,q,S,y){if(U.visible){var r=this._defaultRulerConfig,H="borderStyle",Y="borderColor",T="borderWidth",j="background",J=U[H]||r[H],I=U[Y]||r[Y],s=U[T]||r[T],W=U.size!=Q?U.size:r.size,O=U[j]||r[j],n=W+s,x=this.$6k(s,J,I,K,E,L,n,d,F,p,q,S,y);C(K,L,"0px"),a?B.setCanvas(K,V-x,W):B.setCanvas(K,W,V-x),C(K,"background",O),C(K,i,m)}else C(K,i,h),C(this.getComponentView(this._component),L,"0px")},$6k:function($,k,l,Q,w,D,W,b,T,M,r,S,H){var d=0;return C(Q,w,$+"px "+k+" "+l),C(this.getComponentView(this._component),D,W+E),b?(C(Q,T,M+E),d+=M):C(Q,T,"0px"),r?(C(Q,S,H+E),d+=H):C(Q,S,"0px"),d},validateImpl:function(){var F=this,u=F._component,A=F.$1k,O=F.$2k,B=F.$3k,M=F.$4k,K=F._view,x=F._defaultRulerConfig,o=F._topRulerConfig,g=F._rightRulerConfig,H=F._bottomRulerConfig,_=F._leftRulerConfig,z=x.size;if(K&&u){var b=o.size!=Q?o.size:z,C=g.size!=Q?g.size:z,e=H.size!=Q?H.size:z,E=_.size!=Q?_.size:z;F.$7k(A,o,"border-bottom",K.offsetWidth,L,!0,_.visible,d,E,g.visible,I,C),F.$7k(O,g,"border-left",K.offsetHeight,I,!1,o.visible,L,b,H.visible,f,e),F.$7k(B,H,"border-top",K.offsetWidth,f,!0,_.visible,d,E,g.visible,I,C),F.$7k(M,_,"border-right",K.offsetHeight,d,!1,o.visible,L,b,H.visible,f,e),F.$13k?delete F.$13k:F.invalidateComponent(u),F.validateComponent(u),F.$5k()}},$5k:function(){function J(O,J,b,c,k,A){if(J.visible){var d=D(O),T=J[L]||l,f=J[Y]!=Q?J[Y]:i,S=J[w]||j,s=J[p]||r,G=J.size!=Q?J.size:W,Lb=J[Z]||P,vb=J[y]||q,Lo=J[g]||$,Im=J[a]!=Q?J[a]:e,Tr=J[v]!=Q?J[v]:o,df=J[x]!=Q?J[x]:E,Uo=J[z]!=Q?J[z]:B,Zo=J[n]!=Q?J[n]:_,th=J[C]!=Q?J[C]:h,Gn=J[M]||Tk,Hh=J[u]||Ni;f&&(T=U[A]=U.$8k(U[A]||T,J[H]||m,J[I]||N,c?X:K,vb)),b.call(U,d,R,V,F,t,G,c?X:K,T,S,s,k,Lb,Lo);var Fm=U.$16k;(Im||Tr)&&Fm&&(c?U.$9k(d,Fm.x,G,Gn,Hh,Im,Tr,df,Uo,Zo,th):U.$10k(d,Fm.y,G,Gn,Hh,Im,Tr,df,Uo,Zo,th,k))}}var U=this,k=U.$1k,b=U.$2k,S=U.$3k,O=U.$4k,d=U._topRulerConfig,G=U._rightRulerConfig,s=U._bottomRulerConfig,A=U._leftRulerConfig,T=U._defaultRulerConfig,f=U._component,c=U.getComponentViewRect(f),X=U.getComponentHZoom(f),K=U.getComponentVZoom(f),R=c.x*X,F=R+c.width*X,V=c.y*K,t=V+c.height*K,W=U._defaultRulerConfig.size,L="defaultMajorTickSpacing",H="maxPhysicalMajorTickSpacing",I="minPhysicalMajorTickSpacing",Y="tickSpacingAdaptable",w="majorTickTextFont",p="majorTickTextColor",Z="majorTickColor",g="minorTickColor",a="guideVisible",v="guideTipVisible",x="guideTipBorderColor",z="guideTipTextColor",n="guideTipTextFont",C="guideTipBackground",M="guideColor",u="guideWidth",y="minMajorTickSpacing",l=T[L],m=T[H],N=T[I],i=T[Y],j=T[w],r=T[p],P=T[Z],q=T[y],$=T[g],e=T[a],o=T[v],E=T[x],B=T[z],_=T[n],h=T[C],Tk=T[M],Ni=T[u];U._view&&f&&(J(k,d,U.$11k,!0,!1,"_currentTopMajorTickSpacing"),J(b,G,U.$12k,!1,!0,"_currentRightMajorTickSpacing"),J(S,s,U.$11k,!0,!0,"_currentBottomMajorTickSpacing"),J(O,A,U.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(f,V,B,X,b){return B>f*X?f=z(V/X/b)*b:f*X>V&&(f=J(B/X/b)*b),f},getHTipText:function(c){var Y=this,g=Y._component,f=0,_=Y._view.getBoundingClientRect();return g.lp?f=k(g.lp({clientX:c.x+_.left,clientY:c.y}).x):f-=k(this.getComponentView(g).style.left)||0,f},$9k:function(D,N,z,V,U,e,T,i,n,I,Y){var c=this,W=c._component;D.save(),B.translateAndScale(D,0,0,1);var m=N-(k(this.getComponentView(W).style.left)||0),u=0;if(N=c.getHTipText(c.$16k),e&&(D.beginPath(),D.fillStyle=V,D.rect(m,u,U,z),D.fill()),T){D.beginPath(),D.textAlign="center",D.textBaseline="middle",D.font=I;var H=D.measureText(N).width+6;D.fillStyle=Y,D.rect(m-H/2,u,H,z),D.fill(),D.strokeStyle=i,D.stroke(),D.beginPath(),D.fillStyle=n,D.fillText(N,m,u+z/2)}D.restore()},getVTipText:function(r){var N=this,R=N._component,O=0,X=N._view.getBoundingClientRect();return R.lp?O=k(R.lp({clientX:r.x,clientY:r.y+X.top}).y):O-=k(this.getComponentView(R).style.top)||0,O},formatScaleText:function(i){return Math.round(i)},$10k:function(m,W,c,v,g,e,N,d,i,X,V,O){var q=this,r=q._component;m.save(),B.translateAndScale(m,0,0,1);var H=c/2,K=W-(k(this.getComponentView(r).style.top)||0);if(W=q.getVTipText(q.$16k),e&&(m.beginPath(),m.fillStyle=v,m.rect(H-c/2,K,c,g),m.fill()),N){m.translate(H,K),m.rotate((O?90:-90)*n/180),m.translate(-H,-K),m.beginPath(),m.textAlign="center",m.textBaseline="middle",m.font=X;var z=m.measureText(W).width+6;m.fillStyle=V,m.rect(H-z/2,K-c/2,z,c),m.fill(),m.strokeStyle=d,m.stroke(),m.fillStyle=i,m.fillText(W,H,K)}m.restore()},$11k:function(i,T,W,u,K,P,H,h,s,m,D,I,l){i.save(),W=0;var g=T,q=u,G=(g+q)/2;T=0,u=q-g,B.translateAndScale(i,0,0,1);var O=0,f=0,J=k(P/2),x=P-J,e=D?0:J,r=h*H,Q=r/10;T-=r,u+=r,i.clearRect(T,0,u-T,P),i.beginPath(),i.fillStyle=l;var b=z(G/Q)*Q-g;for(O=b;u>O;O+=Q)i.rect(O,W+e,1,x);for(O=b;O>T;O-=Q)i.rect(O,W+e,1,x);for(i.fill(),e=D?0:1,i.beginPath(),i.fillStyle=I,b=z(G/r)*r-g,O=b;u>O;O+=r)i.rect(O,W+e,1,P-1);for(O=b;O>T;O-=r)i.rect(O,W+e,1,P-1);i.fill();var V=k(/\d+px/.exec(s)[0]),$=(V||10)/2;i.textBaseline="middle",e=D?P-$-2:$+2,i.beginPath(),i.fillStyle=m,i.font=s;var L=z(G/r)*r/H;for(O=b,f=L;u>O;O+=r,f+=h){var Z=this.getHScaleText?this.getHScaleText(O):f;i.fillText(this.formatScaleText(Z),O+2,W+e)}for(O=b,f=L;O>T;O-=r,f-=h){var Z=this.getHScaleText?this.getHScaleText(O):f;i.fillText(this.formatScaleText(Z),O+2,W+e)}i.restore()},$12k:function(s,c,K,y,S,U,e,l,_,j,W,x,J){function o(F,A,t,R,q,r){q=Q.getVScaleText?Q.getVScaleText(t):q,q=Q.formatScaleText(q),s.translate(F+A,t),s.rotate(-R),s.translate(-F-A,-t),s.fillText(q,F+A+(r?2:1),t),s.translate(F+A,t),s.rotate(R),s.translate(-F-A,-t)}s.save(),c=0;var F=K,Z=S,Y=(F+Z)/2;K=0,S=Z-F,B.translateAndScale(s,0,0,1);var b=0,Q=this,g=0,i=k(U/2),N=U-i,t=W?0:i,P=l*e,A=P/10;K-=P,S+=P,s.clearRect(c,0,U,S-K),s.beginPath(),s.fillStyle=J;var G=z(Y/A)*A-F;for(b=G;S>b;b+=A)s.rect(c+t,b,N,1);for(b=G;b>K;b-=A)s.rect(c+t,b,N,1);for(s.fill(),t=W?0:1,s.beginPath(),s.fillStyle=x,G=z(Y/P)*P-F,b=G;S>b;b+=P)s.rect(c+t,b,U-1,1);for(b=G;b>K;b-=P)s.rect(c+t,b,U-1,1);s.fill();var O=k(/\d+px/.exec(_)[0]),d=(O||10)/2,w=90*n/180;s.textBaseline="middle",t=W?U-d:d+2,w=W?-w:w,s.beginPath(),s.fillStyle=j,s.font=_;var u=z(Y/P)*P/e;for(b=G,g=u;S>b;b+=P,g+=l)o(c,t,b,w,g,W);for(b=G,g=u;b>K;b-=P,g-=l)o(c,t,b,w,g,W);s.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var u=this,Z=u._component,M=u._view;Z&&u.removeComponentPropertyChangeListener(Z,u.$14k),M&&(X(M,"mousemove",u.$15k),S(M.parentNode,M),u._view=null)}})}(this,Object);