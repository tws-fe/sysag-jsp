!function(L,x,g){"use strict";var _="px",$="0",E="innerHTML",n="className",C=ht.Default,f=ht.Color,K=ht.Node,i="position",R="top",D="left",z=C.animate,N=C.getInternal(),c="width",$="0",B="none",s="max-height",V="font",S="background",w="border-box",b="user-select",r="box-sizing",o="overflow",T=C.isTouchable,N=C.getInternal(),P=f.titleIconBackground,M=C.scrollBarInteractiveSize,I=/msie 9/.test(L.navigator?L.navigator.userAgent.toLowerCase():""),Y=null,v=function(){return document},u=function(e){return v().createElement(e)},W=function(){return u("div")},F=function(){var V=W(),w=V.style;return w.msTouchAction=B,w.cursor="default",T&&w.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",Y),w.position="absolute",w.left=$,w.top=$,V},X=function(){return u("canvas")},j=function(){return document.body},O=function(j,B,T){j.style.setProperty(B,T,Y)},e=function(V,v){V.style.removeProperty(v)},l=function(U,Z,o){C.def(ht.widget[U],Z,o)},a=function(o,u){o.appendChild(u)},t=function(q,j){q.removeChild(j)},m=function(U,I,p,L){U.addEventListener(I,p,!!L)};N.addMethod(C,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:P,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:P}]},paletteTitleLabelColor:C.labelSelectColor,paletteTitleLabelFont:C.labelFont,paletteContentLabelFont:C.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:C.widgetTitleHeight,paletteTitleBackground:f.titleBackground,paletteTitleHoverBackground:f.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:g,paletteItemHoverBorderColor:f.highlight,paletteItemSelectBackground:f.highlight},!0);var Q=".palette-item:hover{border: 1px solid "+C.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+C.paletteTitleHoverBackground+" !important}",q=document.createElement("style");T||(q.styleSheet?q.styleSheet.cssText=Q:q.appendChild(v().createTextNode(Q))),v().getElementsByTagName("head")[0].appendChild(q);var y=function(K){var q=this;q.$22h=K,q.addListeners()};C.def(y,x,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var O=this;O.$36h&&j().removeChild(O.$36h),O.$23h=O.$24h=O.$25h=O.$35h=O.$36h=Y},handle_touchstart:function(k){for(var h,N=this,q=N.$22h,x=k.target,U=q.sm(),y=q.dm(),w="palette-header",V="palette-item",e=!1,J=!1;x&&(x[n]||"").indexOf(w)<0&&(x[n]||"").indexOf(V)<0;)x=x.parentNode;if(x&&x[n].indexOf(w)>=0?J=!0:x&&x[n].indexOf(V)>=0&&(e=!0),C.isLeftButton(k))if(N.$27h(k))N.$24h=C.getClientPoint(k),N.$25h=q.ty();else if(J){C.preventDefault(k),h=x.$11h;var t=y.getDataById(h);t.isExpanded()?t.setExpanded(!1):t.setExpanded(!0)}else if(e){h=x.$11h;var a=y.getDataById(h);U.ss(a),q.handleDragAndDrop&&(C.preventDefault(k),a.s("draggable")&&(q.handleDragAndDrop(k,"prepare"),N.$35h=0))}else C.preventDefault(k),N.$24h=C.getClientPoint(k),N.$25h=q.ty();else N.$26h(k)},handle_mousedown:function(C){this.handle_touchstart(C)},handle_mousewheel:function(c){this.handleScroll(c,c.wheelDelta/40,c.wheelDelta!==c.wheelDeltaX)},handle_DOMMouseScroll:function(A){this.handleScroll(A,-A.detail,1)},handleScroll:function(p,X,G){var k=this.$22h;C.preventDefault(p),G&&k._41o()&&k.ty(k.ty()+20*X)},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(z){var t=this;t.$37h(z),t.$26h(z)},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(b){var c=this;c.$37h(b),c.$26h(b)},$37h:function(u){var P=this,j=P.$22h;2===P.$35h&&(P.$35h=3,j.handleDragAndDrop(u,"end"))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(c){var P=this,b=P.$22h,$=P.$23h,Q=P.$24h,Y=P.$25h,k=C.getClientPoint(c),S=b._29I,u=P.$36h;if(1===P.$35h||2===P.$35h){if(P.$35h=2,b.handleDragAndDrop(c,"between"),T){var i=c.touches[0];c=i?i:c.changedTouches[0]}u.style.left=c.pageX-parseInt(u.width)/2+_,u.style.top=c.pageY-parseInt(u.height)/2+_}else"p"===$?b.ty(Y+k.y-Q.y):"v"===$&&b.ty(Y+(Q.y-k.y)/S.height*b._59I)},handle_mousemove:function(F){this.handle_touchmove(F)},handle_touchmove:function(M){if(!C.isDragging()&&C.isLeftButton(M)){var S=this,G=S.$22h,n=S.$27h(M);if(S.$24h){if(!S.$23h){if(C.getDistance(C.getClientPoint(M),S.$24h)<2)return;S.$23h=n?"v":"p",C.startDragging(S)}}else if(n)G._43o();else if(0===S.$35h){if(S.$35h=1,G.handleDragAndDrop(M,"begin"),T){var D=M.touches[0];M=D?D:M.changedTouches[0]}var p=S.$36h=new Image,v=G.$10h[G.sm().ld().getId()].querySelector(".image-box"),f=parseInt(v.style.width),g=parseInt(v.style.height);p.draggable=!1,p.src=v.toDataURL(),p.width=f,p.height=g,p.style.position="absolute",p.style.left=M.pageX-f/2+_,p.style.top=M.pageY-g/2+_,j().appendChild(p),C.startDragging(S)}}},$27h:function(f){var S=this.$22h,n=S.getView(),L=n.getBoundingClientRect(),D=S._29I,C=f.clientX-L.left+n.scrollLeft;return S._41o()&&D.x+D.width-C<M}}),ht.widget.Palette=function(U){var s=this,M=s._view=W();s.$9h={},s.$10h={},s.$4h={},s._29I={x:0,y:0,width:0,height:0},s._59I=0,s.dm(U?U:new ht.DataModel),M[n]="ht-widget-palette",s.$29h=new y(s),O(M,S,C.paletteContentBackground),O(M,o,"auto"),O(M,r,w),O(M,"-moz-"+r,w),O(M,"-webkit-"+b,B),O(M,"-moz-"+b,B),O(M,"-ms-"+b,B),O(M,b,B),O(M,"position","absolute"),O(M,"overflow","hidden"),a(M,s._79O=F()),m(M,"dragstart",function(R){R.dataTransfer.setData("Text","nodeid:"+R.target.$11h),R.dataTransfer.effectAllowed="all",s.$29h.$26h()})},l("Palette",x,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:C.autoHideScrollBar,_scrollBarSize:C.scrollBarSize,_scrollBarColor:C.scrollBarColor,getViewRect:function(){return this._29I},ty:function(k){return k?(this.setTranslateY(k),void 0):this.getTranslateY()},setTranslateY:function(E){if(this.$32h==Y){var h=this,X=h.$33h(E),W=h.$30h;h.$30h=X,h.fp("translateY",W,X)}},getTranslateY:function(){return this.$30h},setLayout:function(r){var d,e,T=this,k=T._layout;T._layout=r,"smallicons"===r?d=e=20:"iconsonly"===r?d=e=50:(d=70,e=50),T.setItemImageWidth(d),T.setItemImageHeight(e),T.setItemImagePadding(4),T.fp("layout",k,r)},$20h:function(){var E=16;return T&&(E*=1.2),E},$19h:function(){return C.paletteTitleHeight},$18h:function(){var q=C.paletteSeparatorWidth,P=C.paletteTitleBackground,j=C.paletteSeparatorColor||C.brighter(P);return q+_+" solid "+j},$17h:function(X){O(X,"cursor","pointer"),O(X,"display","inline-block"),O(X,"margin-right",(T?8:4)+_),O(X,"vertical-align",R)},$1h:function(Y){var z=this,L=W(),G=W(),F=u("span");L[n]="palette-header",O(L,i,"relative"),O(L,S,C.paletteTitleBackground),O(L,"color",C.paletteTitleLabelColor),O(L,R,$),O(L,r,w),O(L,"-moz-"+r,w),O(L,"padding","0 5px 0 0"),O(L,"border-top",z.$18h()),O(L,c,"100%"),O(L,"cursor","pointer"),O(L,"white-space","nowrap"),O(L,o,"hidden"),O(L,V,C.paletteTitleLabelFont),O(L,"line-height",z.$19h()+_),L.$11h=Y.getId();var l=X(),f=z.$19h(),e=z.$20h();return z.$17h(l),N.setCanvas(l,e,f),a(L,l),l[n]="palette-toggle-icon-"+Y.getId(),G[n]="palette-content",O(G,"max-height",0+_),O(G,V,C.paletteContentLabelFont),O(G,o,"hidden"),G.$11h=Y.getId(),z.$9h[Y.getId()]=G,F[E]=Y.getName(),O(F,V,C.paletteTitleLabelFont),a(L,l),a(L,F),[L,G]},$2h:function(M){var Y=this,z=Y._layout,$=I&&M.s("draggable")?u("a"):W(),r=X(),Z=W(),b=M.getName()||"",l=M.s("title")||M.getToolTip()||b,i=Y._itemMargin;r[n]="image-box";var h=Y.getItemImageWidth(),L=Y.getItemImageHeight();return N.setCanvas(r,h,L),a($,r),Z[E]=b,Z[n]="label-box","iconsonly"!==z&&a($,Z),$[n]="palette-item",O($,"vertical-align",R),O($,"cursor","pointer"),O($,"border-radius",5+_),O($,"border","1px solid transparent"),O($,"text-align","center"),O($,"display","inline-block"),O($,"margin-left",i+_),O($,"margin-top",i+_),O($,"color",C.paletteContentLabelColor),"smallicons"===z?(O(r,"vertical-align","middle"),O($,"margin-left",2+_),O($,"margin-top",2+_),O($,"padding",2+_),O($,"text-align",D),O(Z,"display","inline-block"),O(Z,"min-width",Y.$21h+Y._itemMargin+_)):"largeicons"===z&&(O(Z,"max-width",h+_),O(Z,"overflow","hidden")),$.$11h=M.getId(),l&&($.title=l),M.s("draggable")&&!Y.handleDragAndDrop&&(I?($.href="#",O($,"text-decoration",B)):$.draggable="true"),$},$16h:function(f,j,V,i){var h=N.initContext(f);N.translateAndScale(h,0,0,1),h.clearRect(0,0,V,V);var z=(V-i)/2;C.drawStretchImage(h,C.getImage(j),"fill",0,z,i,i),h.restore()},$15h:function(y){var G=this,r=y.getId(),u=G._view.querySelector(".palette-toggle-icon-"+r),P=y.isExpanded()?C.paletteCollapseIcon:C.paletteExpandIcon;if(u&&P){var b=G.$19h(),I=G.$20h();G.$16h(u,P,b,I)}},$14h:function(n){var f=this,F=n.getId(),c=f.$10h[F].querySelector(".image-box"),P=n.getImage(),E=n.s("image.stretch");if(c&&P){var Y=N.initContext(c),g=f.getItemImagePadding();g="smallicons"===f._layout?g/2:g;var i=f.getItemImageWidth()-2*g,q=f.getItemImageHeight()-2*g;N.translateAndScale(Y,0,0,1),Y.clearRect(0,0,i,q),C.drawStretchImage(Y,C.getImage(P),E,g,g,i,q),Y.restore()}},validateImpl:function(){var I,O,y,j=this,o=j.$9h,c=j._layout,M=j.$10h,n=j.$4h,H=j._view,r=j.dm();if(j.$13h&&(delete j.$13h,n={},r.each(function(X){n[X.getId()]=X})),"smallicons"===c)for(var f in n){var J=n[f];if(J instanceof K){var m=J.getName()||"",p=C.getTextSize(C.paletteContentLabelFont,m).width;j.$21h!=Y&&j.$21h>p||(j.$21h=p)}}for(var f in n){y=n[f];var x,i;if(r.contains(y)){if(y instanceof ht.Group){var N,q=j.$1h(y),e=M[y.getId()];e&&(N=e.nextSibling,t(H,N),t(H,e)),O=r.getSiblings(y).indexOf(y);var T=H.children[2*O]||j._79O;H.insertBefore(q[0],T),H.insertBefore(N||q[1],T),M[y.getId()]=q[0],I=o[y.getId()]=N||q[1],i=y.$12h;var l=y.s("promptText");i||(y.$12h=u("div"),y.$12h[E]=l||"",i=y.$12h),0===y.getChildren().size()?I.contains(i)||a(I,i):I.contains(i)&&t(I,i)}else if(x=y.getParent()){var B=j.$2h(y),g=M[y.getId()];I=o[x.getId()],g&&t(g.parentNode,g),O=r.getSiblings(y).indexOf(y);var v=I.children[O];v?I.insertBefore(B,v):a(I,B),M[y.getId()]=B,j.$14h(y)}}else{var G=M[y.getId()],F=G.parentNode;if(y instanceof ht.Group){var Q=G.nextSibling;t(H,G),t(H,Q),delete o[y.getId()]}else t(F,G),0===F.children.length&&(x=r.getDataById(F.$11h),i=x.$12h,i&&!F.contains(i)&&a(F,i));delete M[y.getId()]}}j.$4h={};var A=function(){var N=j._59I,h=0;j.$32h!=Y&&(clearInterval(j.$32h),h=0,delete j.$32h),j.$32h=setInterval(function(){j.$31h(),N===j._59I?(h++,h>=2&&(clearInterval(j.$32h),delete j.$32h)):(h=0,N=j._59I)},30)};for(var X in o)if(I=o[X],y=r.getDataById(o[X].$11h),j.$15h(y),y.isExpanded()){if(I.style.maxHeight===0+_){var L=I.scrollHeight+j._itemMargin+_;z(I).duration(200).set(s,L).set("padding-bottom",j._itemMargin+_).end(function(){return function(){A()}}(L))}else I.style.maxHeight=I.scrollHeight+_;I.style.paddingBottom=j._itemMargin+_}else I.style.maxHeight!==0+_&&z(I).duration(200).set(s,$).set("padding-bottom",$).end(function(){return function(){A()}}(I));j.$28h(),j.$31h()},$31h:function(){for(var y=this,D=y._view,g=0,j=D.children,W=0;W<j.length;W++){var r=j[W];r.className&&r.className.indexOf("palette-")>=0&&(g+=r.offsetHeight)}y._59I=g,y.$30h=y.$33h(y.ty());var m=y.ty();D.scrollTop=-m,y._29I={x:0,y:-m,width:D.clientWidth,height:D.clientHeight},O(y._79O,R,-m+_),y._93I()},$33h:function(X){var c=this,w=c._29I.height-c._59I;return w>X&&(X=w),X>0?0:Math.round(X)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(T){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(T.property)<0&&this.redraw(),"translateY"===T.property&&(this.iv(),this._43o())},findDataByName:function(A){for(var $=this.dm().getDatas(),W=0;W<$.size();W++){var G=$.get(W);if(G.getName()===A)return G}},setDataModel:function(Q){var f=this,p=f._dataModel,b=f._3o;p!==Q&&(p&&(p.umm(f.$6h,f),p.umd(f.$8h,f),p.umh(f.$7h,f),b||p.sm().ums(f.$28h,f)),f._dataModel=Q,Q.mm(f.$6h,f),Q.md(f.$8h,f),Q.mh(f.$7h,f),b?b._21I(Q):Q.sm().ms(f.$28h,f),f.sm().setSelectionMode("single"),f.fp("dataModel",p,Q))},$6h:function(Z){var r=this,A=r._view,z=Z.data,Y=r.$4h;"add"===Z.kind?Y[z.getId()]=z:"remove"===Z.kind?Y[z.getId()]=z:"clear"===Z.kind&&(r.$10h={},r.$9h={},r.$4h={},A[E]=""),r.iv()},$7h:function(N){var L=this,W=N.data;L.$4h[W.getId()]=W,L.iv()},$8h:function(Q){var k=this,A=Q.data,m=Q.property;"expanded"===m?k.iv():(k.$4h[A.getId()]=A,k.iv())},$28h:function(){var z,Y=this,p=Y.sm(),x="palette-item",y=p.ld();this.dm().each(function(A){z=Y.$10h[A.getId()],z&&z[n].indexOf(x)>=0&&(A===y?O(z,S,C.paletteItemSelectBackground):e(z,S))})}})}(this,Object);